mtext(text="SS Interim",side=1,line=2,at=-0.05)
mtext(text="Follow-up",side=1,line=3,at=-0.05)
mtext(text="SS Final",side=1,line=4,at=-0.05)
outer[,,"eff.mon.initial"]
outer[,,"eff.mon.final"]
k1
enr.shape
#### Type I error graphs ####
#c(bottom, left, top, right)
par(mar=c(5.1+4,4.1+2,2.1,2.1))
par(mfrow = c(1, 1))
k1<-4
k2<-1
plot(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],
type='l',ylim=c(0,.15),lwd=2,lty='longdash',
ylab="Type 1 Error Rate",xlab="",
main="",
axes=FALSE)
plot(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],
type='l',ylim=c(0,.15),lwd=2,lty='longdash',
ylab="Type 1 Error Rate",xlab="",
main="",
axes=FALSE)
plot(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],
type='l',ylim=c(0,.15),lwd=2,lty='longdash',
ylab="Type 1 Error Rate",xlab="",
main="",
axes=FALSE)
plot(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],
type='l',ylim=c(0,.15),lwd=2,lty='longdash',
ylab="Type 1 Error Rate",xlab="",
main="",
axes=FALSE)
text(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],
labels=format(round(outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],digits=3),
nsmall=3),pos=3)
lines(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.final"][out.mean==k1 & enr.shape==k2],lwd=2)
text(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.final"][out.mean==k1 & enr.shape==k2],
labels=format(round(outer[,,"eff.mon.final"][out.mean==k1 & enr.shape==k2],digits=3),
nsmall=3),pos=1)
box()
# yaxixs
axis(2,las=2,at=seq(0,.15,by=0.01),labels=format(seq(0,.15,by=0.01),nsmall=2))
# x axis
axis(1,las=0,at=1/freq.mntr[out.mean==k1 & enr.shape==k2],
labels=c("","","","","",""))
# manual x-axis
mtext(text=freq.mntr,side=1,line=1,at=1/freq.mntr[out.mean==k1 & enr.shape==k2])
# horizontal lines
abline(h=seq(0,0.15,by=0.01),col='grey')
# sample size information
mtext(text=paste0(format(round(
outer[,,"ss.initial"][out.mean==k1 & enr.shape==k2],
digits=1),nsmall=1)),
side=1,line=2,at=1/freq.mntr)
mtext(text=paste0(format(round(
outer[,,"ss.final"][out.mean==k1 & enr.shape==k2]-
outer[,,"ss.initial"][out.mean==k1 & enr.shape==k2],
digits=1),nsmall=1)),
side=1,line=3,at=1/freq.mntr)
mtext(text=paste0(format(round(
outer[,,"ss.final"][out.mean==k1 & enr.shape==k2],
digits=1),nsmall=1)),
side=1,line=4,at=1/freq.mntr)
mtext(text="Monitor Freq",side=1,line=1,at=-0.05)
mtext(text="SS Interim",side=1,line=2,at=-0.05)
mtext(text="Follow-up",side=1,line=3,at=-0.05)
mtext(text="SS Final",side=1,line=4,at=-0.05)
#### Type I error graphs ####
#c(bottom, left, top, right)
par(mar=c(5.1+4,4.1+2,2.1,2.1))
par(mfrow = c(1, 1))
k1<-4
k2<-1
plot(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],
type='l',ylim=c(0,.15),lwd=2,lty='longdash',
ylab="Type 1 Error Rate",xlab="",
main="",
axes=FALSE)
# horizontal lines
abline(h=seq(0,0.15,by=0.01),col='grey')
text(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],
labels=format(round(outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],digits=3),
nsmall=3),pos=3)
lines(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.final"][out.mean==k1 & enr.shape==k2],lwd=2)
lines(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],lwd=2)
text(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.final"][out.mean==k1 & enr.shape==k2],
labels=format(round(outer[,,"eff.mon.final"][out.mean==k1 & enr.shape==k2],digits=3),
nsmall=3),pos=1)
box()
# yaxixs
axis(2,las=2,at=seq(0,.15,by=0.01),labels=format(seq(0,.15,by=0.01),nsmall=2))
# x axis
axis(1,las=0,at=1/freq.mntr[out.mean==k1 & enr.shape==k2],
labels=c("","","","","",""))
# manual x-axis
mtext(text=freq.mntr,side=1,line=1,at=1/freq.mntr[out.mean==k1 & enr.shape==k2])
# sample size information
mtext(text=paste0(format(round(
outer[,,"ss.initial"][out.mean==k1 & enr.shape==k2],
digits=1),nsmall=1)),
side=1,line=2,at=1/freq.mntr)
mtext(text=paste0(format(round(
outer[,,"ss.final"][out.mean==k1 & enr.shape==k2]-
outer[,,"ss.initial"][out.mean==k1 & enr.shape==k2],
digits=1),nsmall=1)),
side=1,line=3,at=1/freq.mntr)
mtext(text=paste0(format(round(
outer[,,"ss.final"][out.mean==k1 & enr.shape==k2],
digits=1),nsmall=1)),
side=1,line=4,at=1/freq.mntr)
mtext(text="Monitor Freq",side=1,line=1,at=-0.05)
mtext(text="SS Interim",side=1,line=2,at=-0.05)
mtext(text="Follow-up",side=1,line=3,at=-0.05)
mtext(text="SS Final",side=1,line=4,at=-0.05)
#### Type I error graphs ####
#c(bottom, left, top, right)
par(mar=c(5.1+4,4.1+2,2.1,2.1))
par(mfrow = c(1, 1))
k1<-4
k2<-1
plot(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],
type='l',ylim=c(0,.15),lwd=2,lty='longdash',
ylab="Type 1 Error Rate",xlab="",
main="",
axes=FALSE)
# horizontal lines
abline(h=seq(0,0.15,by=0.01),col='grey')
text(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],
labels=format(round(outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],digits=3),
nsmall=3),pos=3)
lines(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.final"][out.mean==k1 & enr.shape==k2],lwd=2)
lines(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.initial"][out.mean==k1 & enr.shape==k2],lty='longdash',lwd=2)
text(1/freq.mntr[out.mean==k1 & enr.shape==k2],
outer[,,"eff.mon.final"][out.mean==k1 & enr.shape==k2],
labels=format(round(outer[,,"eff.mon.final"][out.mean==k1 & enr.shape==k2],digits=3),
nsmall=3),pos=1)
box()
# yaxixs
axis(2,las=2,at=seq(0,.15,by=0.01),labels=format(seq(0,.15,by=0.01),nsmall=2))
# x axis
axis(1,las=0,at=1/freq.mntr[out.mean==k1 & enr.shape==k2],
labels=c("","","","","",""))
# manual x-axis
mtext(text=freq.mntr,side=1,line=1,at=1/freq.mntr[out.mean==k1 & enr.shape==k2])
# sample size information
mtext(text=paste0(format(round(
outer[,,"ss.initial"][out.mean==k1 & enr.shape==k2],
digits=1),nsmall=1)),
side=1,line=2,at=1/freq.mntr)
mtext(text=paste0(format(round(
outer[,,"ss.final"][out.mean==k1 & enr.shape==k2]-
outer[,,"ss.initial"][out.mean==k1 & enr.shape==k2],
digits=1),nsmall=1)),
side=1,line=3,at=1/freq.mntr)
mtext(text=paste0(format(round(
outer[,,"ss.final"][out.mean==k1 & enr.shape==k2],
digits=1),nsmall=1)),
side=1,line=4,at=1/freq.mntr)
mtext(text="Monitor Freq",side=1,line=1,at=-0.05)
mtext(text="SS Interim",side=1,line=2,at=-0.05)
mtext(text="Follow-up",side=1,line=3,at=-0.05)
mtext(text="SS Final",side=1,line=4,at=-0.05)
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/")
source("code_functions.R")
p.skpt<-0.20      # response rate for skeptic, enthusiast, futility
p.enth<-0.40
p.intr<-0.30
tail.skpt<-0.045  # tail probabilities for priors (low, high)
tail.enth<-0.05
source("code_headers.R")
spike<-1 # spike/slab version or regular version
sig.fut<-0.85
sig.eff<-0.95
cred.tail<-0.05
max.ss<-76
reps<-10000
p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
freq.mntr<-2      # frequency of monitoring
enr.shape<-1      # shape gamma dist enrollment
out.mean<-4       # mean normal dist outcome
source("code_main.R")
mix.2
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/")
source("code_functions.R")
p.skpt<-0.20      # response rate for skeptic, enthusiast, futility
p.enth<-0.40
p.intr<-0.30
tail.skpt<-0.045  # tail probabilities for priors (low, high)
tail.enth<-0.05
source("code_headers.R")
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/")
source("code_functions.R")
p.skpt<-0.20      # response rate for skeptic, enthusiast, futility
p.enth<-0.40
p.intr<-0.30
tail.skpt<-0.045  # tail probabilities for priors (low, high)
tail.enth<-0.05
source("code_headers.R")
spike<-1 # spike/slab version or regular version
sig.fut<-0.85
sig.eff<-0.95
cred.tail<-0.05
max.ss<-76
reps<-10000
p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
freq.mntr<-2      # frequency of monitoring
enr.shape<-1      # shape gamma dist enrollment
out.mean<-4       # mean normal dist outcome
source("code_main.R")
# p.skpt<-0.20      # response rate for skeptic, enthusiast, futility
# p.enth<-0.40
# p.intr<-0.30
# tail.skpt<-0.045  # tail probabilities for priors (low, high)
# tail.enth<-0.05
# source("code_headers.R")
#
# spike<-0 # spike/slab version or regular version
# sig.fut<-0.85
# sig.eff<-0.95
# cred.tail<-0.05
# max.ss<-76
# reps<-60000
# #p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
# p.range<-0.2
# #freq.mntr<-2      # frequency of monitoring
# freq.mntr<-c(1,2,4,8,16,76)
# #freq.mntr<-rep(c(1,2,4,8,16,80),4)
# #enr.shape<-1      # shape gamma dist enrollment
# #enr.shape<-c(rep(1,12),rep(0.25,12))
# enr.shape<-rep(1,6)
# #out.mean<-4       # mean normal dist outcome
# out.mean<-rep(4,6)
# #out.mean<-rep(c(rep(4,6),rep(8,6)),2)
# source("code_main.R")
# source("plots_t1e.R")
# spike<-0 # spike/slab version or regular version
# sig.fut<-0.85
# sig.eff<-0.95
# cred.tail<-0.05
# max.ss<-76
# reps<-10000
# p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
# #p.range<-0.15
# freq.mntr<-2      # frequency of monitoring
# #freq.mntr<-c(1,2,4,8,16,76)
# #freq.mntr<-rep(c(1,2,4,8,16,80),4)
# enr.shape<-1      # shape gamma dist enrollment
# #enr.shape<-c(rep(1,12),rep(0.25,12))
# #enr.shape<-rep(1,6)
# out.mean<-4       # mean normal dist outcome
# #out.mean<-rep(4,6)
# #out.mean<-rep(c(rep(4,6),rep(8,6)),2)
# source("code_main.R")
## Sequential design properties
# label_main=""
# stretch<-0.125
# source("plots_seq_design_prop.R")
## Futility example
#n<-   c(0,8,16,24,32,40)
#y1<-  c(0,1,2, 5, 5,8)
#miss<-c(0,6,4, 13,8,0)
#stretch<-2.5 # "Sample Size" labels xlim
## Efficacy example
# n<-c(0,8,16,19)
# y1<-c(0,4,9,11)
# miss<-c(0,11,3,0)
# y0=n-y1
# stretch<-1.5
# source("plots_violin.R")
# gt <- ggplot_gtable(ggplot_build(p))
# gt$layout$clip[gt$layout$name == "panel"] <- "off"
# grid.draw(gt)
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/")
source("code_functions.R")
p.skpt<-0.20      # response rate for skeptic, enthusiast, futility
p.enth<-0.40
p.intr<-0.30
tail.skpt<-0.045  # tail probabilities for priors (low, high)
tail.enth<-0.05
source("code_headers.R")
spike<-1 # spike/slab version or regular version
sig.fut<-0.85
sig.eff<-0.95
cred.tail<-0.05
max.ss<-76
reps<-1000
p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
freq.mntr<-2      # frequency of monitoring
enr.shape<-1      # shape gamma dist enrollment
out.mean<-4       # mean normal dist outcome
source("code_main.R")
# p.skpt<-0.20      # response rate for skeptic, enthusiast, futility
# p.enth<-0.40
# p.intr<-0.30
# tail.skpt<-0.045  # tail probabilities for priors (low, high)
# tail.enth<-0.05
# source("code_headers.R")
#
# spike<-0 # spike/slab version or regular version
# sig.fut<-0.85
# sig.eff<-0.95
# cred.tail<-0.05
# max.ss<-76
# reps<-60000
# #p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
# p.range<-0.2
# #freq.mntr<-2      # frequency of monitoring
# freq.mntr<-c(1,2,4,8,16,76)
# #freq.mntr<-rep(c(1,2,4,8,16,80),4)
# #enr.shape<-1      # shape gamma dist enrollment
# #enr.shape<-c(rep(1,12),rep(0.25,12))
# enr.shape<-rep(1,6)
# #out.mean<-4       # mean normal dist outcome
# out.mean<-rep(4,6)
# #out.mean<-rep(c(rep(4,6),rep(8,6)),2)
# source("code_main.R")
# source("plots_t1e.R")
# spike<-0 # spike/slab version or regular version
# sig.fut<-0.85
# sig.eff<-0.95
# cred.tail<-0.05
# max.ss<-76
# reps<-10000
# p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
# #p.range<-0.15
# freq.mntr<-2      # frequency of monitoring
# #freq.mntr<-c(1,2,4,8,16,76)
# #freq.mntr<-rep(c(1,2,4,8,16,80),4)
# enr.shape<-1      # shape gamma dist enrollment
# #enr.shape<-c(rep(1,12),rep(0.25,12))
# #enr.shape<-rep(1,6)
# out.mean<-4       # mean normal dist outcome
# #out.mean<-rep(4,6)
# #out.mean<-rep(c(rep(4,6),rep(8,6)),2)
# source("code_main.R")
## Sequential design properties
# label_main=""
# stretch<-0.125
# source("plots_seq_design_prop.R")
## Futility example
#n<-   c(0,8,16,24,32,40)
#y1<-  c(0,1,2, 5, 5,8)
#miss<-c(0,6,4, 13,8,0)
#stretch<-2.5 # "Sample Size" labels xlim
## Efficacy example
# n<-c(0,8,16,19)
# y1<-c(0,4,9,11)
# miss<-c(0,11,3,0)
# y0=n-y1
# stretch<-1.5
# source("plots_violin.R")
# gt <- ggplot_gtable(ggplot_build(p))
# gt$layout$clip[gt$layout$name == "panel"] <- "off"
# grid.draw(gt)
source("plots_seq_design_prop.R")
label_main=""
source("plots_seq_design_prop.R")
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/")
source("code_functions.R")
p.skpt<-0.20      # response rate for skeptic, enthusiast, futility
p.enth<-0.40
p.intr<-0.30
tail.skpt<-0.045  # tail probabilities for priors (low, high)
tail.enth<-0.05
source("code_headers.R")
spike<-1 # spike/slab version or regular version
sig.fut<-0.85
sig.eff<-0.95
cred.tail<-0.05
max.ss<-76
reps<-12000
p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
freq.mntr<-2      # frequency of monitoring
enr.shape<-1      # shape gamma dist enrollment
out.mean<-4       # mean normal dist outcome
source("code_main.R")
label_main=""
source("plots_seq_design_prop.R")
# p.skpt<-0.20      # response rate for skeptic, enthusiast, futility
# p.enth<-0.40
# p.intr<-0.30
# tail.skpt<-0.045  # tail probabilities for priors (low, high)
# tail.enth<-0.05
# source("code_headers.R")
#
# spike<-0 # spike/slab version or regular version
# sig.fut<-0.85
# sig.eff<-0.95
# cred.tail<-0.05
# max.ss<-76
# reps<-60000
# #p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
# p.range<-0.2
# #freq.mntr<-2      # frequency of monitoring
# freq.mntr<-c(1,2,4,8,16,76)
# #freq.mntr<-rep(c(1,2,4,8,16,80),4)
# #enr.shape<-1      # shape gamma dist enrollment
# #enr.shape<-c(rep(1,12),rep(0.25,12))
# enr.shape<-rep(1,6)
# #out.mean<-4       # mean normal dist outcome
# out.mean<-rep(4,6)
# #out.mean<-rep(c(rep(4,6),rep(8,6)),2)
# source("code_main.R")
# source("plots_t1e.R")
# spike<-0 # spike/slab version or regular version
# sig.fut<-0.85
# sig.eff<-0.95
# cred.tail<-0.05
# max.ss<-76
# reps<-10000
# p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
# #p.range<-0.15
# freq.mntr<-2      # frequency of monitoring
# #freq.mntr<-c(1,2,4,8,16,76)
# #freq.mntr<-rep(c(1,2,4,8,16,80),4)
# enr.shape<-1      # shape gamma dist enrollment
# #enr.shape<-c(rep(1,12),rep(0.25,12))
# #enr.shape<-rep(1,6)
# out.mean<-4       # mean normal dist outcome
# #out.mean<-rep(4,6)
# #out.mean<-rep(c(rep(4,6),rep(8,6)),2)
# source("code_main.R")
## Sequential design properties
# label_main=""
# stretch<-0.125
# source("plots_seq_design_prop.R")
## Futility example
#n<-   c(0,8,16,24,32,40)
#y1<-  c(0,1,2, 5, 5,8)
#miss<-c(0,6,4, 13,8,0)
#stretch<-2.5 # "Sample Size" labels xlim
## Efficacy example
# n<-c(0,8,16,19)
# y1<-c(0,4,9,11)
# miss<-c(0,11,3,0)
# y0=n-y1
# stretch<-1.5
# source("plots_violin.R")
# gt <- ggplot_gtable(ggplot_build(p))
# gt$layout$clip[gt$layout$name == "panel"] <- "off"
# grid.draw(gt)
source("plots_seq_design_prop.R")
stretch<-0.125
source("plots_seq_design_prop.R")
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/")
source("code_functions.R")
p.skpt<-0.20      # response rate for skeptic, enthusiast, futility
p.enth<-0.40
p.intr<-0.30
tail.skpt<-0.045  # tail probabilities for priors (low, high)
tail.enth<-0.05
source("code_headers.R")
spike<-1 # spike/slab version or regular version
sig.fut<-0.85
sig.eff<-0.95
cred.tail<-0.05
max.ss<-76
reps<-12000
p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
freq.mntr<-2      # frequency of monitoring
enr.shape<-1      # shape gamma dist enrollment
out.mean<-4       # mean normal dist outcome
source("code_main.R")
label_main=""
stretch<-0.125
source("plots_seq_design_prop.R")
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/")
source("code_functions.R")
p.skpt<-0.20      # response rate for skeptic, enthusiast, futility
p.enth<-0.40
p.intr<-0.30
tail.skpt<-0.045  # tail probabilities for priors (low, high)
tail.enth<-0.05
source("code_headers.R")
spike<-1 # spike/slab version or regular version
sig.fut<-0.85
sig.eff<-0.95
cred.tail<-0.05
max.ss<-76
reps<-8000
p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05) # range of response proportion
freq.mntr<-2      # frequency of monitoring
enr.shape<-1      # shape gamma dist enrollment
out.mean<-4       # mean normal dist outcome
source("code_main.R")
label_main=""
stretch<-0.125
source("plots_seq_design_prop.R")

plot(x,prior.nc.enth(x),type="l",
xlab="Response Probability",
ylab="",
main="",
#xaxt="n",
yaxt="n",
ylim=c(0,2.5))
#axis(2,at=c(0,1,2,3),labels=c(0,1,2,3))
polygon(c(x[x<=p.skpt],p.skpt),c(prior.nc.enth(x)[x<=p.skpt],0),col="black")
polygon(c(p.skpt,x[x>=p.skpt],1),c(0,prior.nc.enth(x)[x>=p.skpt],0),col="lightgrey")
# print the overall labels
mtext('Response Probability', side = 1, outer = TRUE, line = .3)
mtext('Density Value', side = 2, outer = TRUE, line = .3)
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/scripts")
### Model arguments  ####################################
p.skpt<-0.40     # response rate for skeptic, enthusiast, futility
p.enth<-0.67
p.intr<-(p.skpt+p.enth)/2
tail.skpt<-0.05  # tail probabilities for priors
tail.enth<-0.05
cred.tail<-0.05
sig.fut<-0.95
sig.eff<-0.95
lambda0.skpt<-2
lambda0.enth<-2
epsilon<-0 # used to stop numerical error from integration
### Parameterize generalized normal priors  ##############
source("code_headers_gen_nrml.R")
### Prior plots  ########################################
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_priors.R")
### Functions  ##########################################
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/functions/functions.R")
### Violin plots ########################################
n<-c(0,6,12,18) # Efficacy example
y1<-c(0,4,8,12)
miss<-c(0,0,0,0)
y0=n-y1
p.range<-1 # temp
j<-1       # temp
stretch<-1.5
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
grid.arrange(plot1)
1+1
grid.arrange(plot1)
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
grid.arrange(plot1)
grid.arrange(plot1)
grid.arrange(plot1)
### Violin plots ########################################
n<-c(0,6,12,18) # Efficacy example
y1<-c(0,4,8,12)
miss<-c(0,0,0,0)
y0=n-y1
p.range<-1 # temp
j<-1       # temp
stretch<-1.5
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
grid.arrange(plot1)
### Violin plots ########################################
n<-c(0,6,12,18) # Efficacy example
y1<-c(0,4,8,12)
miss<-c(0,0,0,0)
y0=n-y1
p.range<-1 # temp
j<-1       # temp
stretch<-1.5
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
grid.arrange(plot1)
grid.arrange(plot1)
grid.arrange(plot1)
spacing
efficacy
futility
mean
n<-   c(0,6,12,18,24,30) # Futility example
y1<-  c(0,2,4, 6, 8,10)
miss<-c(0,0,0, 0,0,0)
y0=n-y1
efficacy<-NA
futility<-NA
mean<-NA
lower<-NA
upper<-NA
for (i in 1:length(n)){
efficacy[i]<-eff_fut(i)[1]
futility[i]<-eff_fut(i)[2]
mean[i]<-pm_cp(i)[1]
lower[i]<-pm_cp(i)[4]
upper[i]<-pm_cp(i)[5]
}
efficacy
futility
1-efficacy
futility
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/scripts")
### Model arguments  ####################################
p.skpt<-0.40     # response rate for skeptic, enthusiast, futility
p.enth<-0.67
p.intr<-(p.skpt+p.enth)/2
tail.skpt<-0.05  # tail probabilities for priors
tail.enth<-0.05
cred.tail<-0.05
sig.fut<-0.95
sig.eff<-0.95
lambda0.skpt<-2
lambda0.enth<-2
epsilon<-0 # used to stop numerical error from integration
### Parameterize generalized normal priors  ##############
source("code_headers_gen_nrml.R")
### Prior plots  ########################################
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_priors.R")
### Functions  ##########################################
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/functions/functions.R")
### Violin plots ########################################
n<-c(0,6,12,18) # Efficacy example
y1<-c(0,4,8,12)
miss<-c(0,0,0,0)
y0=n-y1
p.range<-1 # temp
j<-1       # temp
stretch<-1.5
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
grid.arrange(plot1)
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/scripts")
### Model arguments  ####################################
p.skpt<-0.40     # response rate for skeptic, enthusiast, futility
p.enth<-0.67
p.intr<-(p.skpt+p.enth)/2
tail.skpt<-0.05  # tail probabilities for priors
tail.enth<-0.05
cred.tail<-0.05
sig.fut<-0.95
sig.eff<-0.95
lambda0.skpt<-2
lambda0.enth<-2
epsilon<-0 # used to stop numerical error from integration
### Parameterize generalized normal priors  ##############
source("code_headers_gen_nrml.R")
### Prior plots  ########################################
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_priors.R")
### Functions  ##########################################
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/functions/functions.R")
### Violin plots ########################################
n<-c(0,6,12,18) # Efficacy example
y1<-c(0,4,8,12)
miss<-c(0,0,0,0)
y0=n-y1
p.range<-1 # temp
j<-1       # temp
stretch<-1.5
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
grid.arrange(plot1)
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/scripts")
### Model arguments  ####################################
p.skpt<-0.40     # response rate for skeptic, enthusiast, futility
p.enth<-0.67
p.intr<-(p.skpt+p.enth)/2
tail.skpt<-0.05  # tail probabilities for priors
tail.enth<-0.05
cred.tail<-0.05
sig.fut<-0.95
sig.eff<-0.95
lambda0.skpt<-2
lambda0.enth<-2
epsilon<-0 # used to stop numerical error from integration
### Parameterize generalized normal priors  ##############
source("code_headers_gen_nrml.R")
### Prior plots  ########################################
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_priors.R")
### Functions  ##########################################
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/functions/functions.R")
### Violin plots ########################################
n<-c(0,6,12,18) # Efficacy example
y1<-c(0,4,8,12)
miss<-c(0,0,0,0)
y0=n-y1
p.range<-1 # temp
j<-1       # temp
stretch<-1.5
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
grid.arrange(plot1)
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
grid.arrange(plot1)
dev.off()
dev.off()
grid.arrange(plot1)
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
grid.arrange(plot1)
n<-   c(0,6,12,18,24,30) # Futility example
y1<-  c(0,2,4, 6, 8,10)
miss<-c(0,0,0, 0,0,0)
y0=n-y1
stretch<-2.5 # "Sample Size" labels xlim
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot2 <- ggplot_gtable(ggplot_build(p))
plot2$layout$clip[plot2$layout$name == "panel"] <- "off"
# plot side-by-side
grid.arrange(plot1,plot2,ncol=2)
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
grid.arrange(plot1)
grid.arrange(plot1)
1+1
grid.arrange(plot1)
futility
efficacy
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/scripts")
### Model arguments  ####################################
p.skpt<-0.40     # response rate for skeptic, enthusiast, futility
p.enth<-0.67
p.intr<-(p.skpt+p.enth)/2
tail.skpt<-0.05  # tail probabilities for priors
tail.enth<-0.05
cred.tail<-0.05
sig.fut<-0.95
sig.eff<-0.95
lambda0.skpt<-2
lambda0.enth<-2
epsilon<-0 # used to stop numerical error from integration
### Parameterize generalized normal priors  ##############
source("code_headers_gen_nrml.R")
### Prior plots  ########################################
source("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/plots/plots_priors.R")
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES")
### Model arguments  ####################################
p.skpt<-0.40     # response rate for skeptic, enthusiast, futility
p.enth<-0.67
p.intr<-(p.skpt+p.enth)/2
tail.skpt<-0.05  # tail probabilities for priors
tail.enth<-0.05
cred.tail<-0.05
sig.fut<-0.95
sig.eff<-0.95
lambda0.skpt<-2
lambda0.enth<-2
epsilon<-0 # used to stop numerical error from integration
### Parameterize generalized normal priors  ##############
source("\scripts\code_headers_gen_nrml.R")
### Parameterize generalized normal priors  ##############
source("/scripts/code_headers_gen_nrml.R")
### Parameterize generalized normal priors  ##############
source("scripts/code_headers_gen_nrml.R")
source("plots/plots_priors.R")
png(filename="prior_plots.png")
source("plots/plots_priors.R")
dev.off()
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES")
### Model arguments  ####################################
p.skpt<-0.40     # response rate for skeptic, enthusiast, futility
p.enth<-0.67
p.intr<-(p.skpt+p.enth)/2
tail.skpt<-0.05  # tail probabilities for priors
tail.enth<-0.05
cred.tail<-0.05
sig.fut<-0.95
sig.eff<-0.95
lambda0.skpt<-2
lambda0.enth<-2
epsilon<-0 # used to stop numerical error from integration
### Parameterize generalized normal priors  #############
source("scripts/code_headers_gen_nrml.R")
### Prior plots  ########################################
png(filename="prior_plots.png")
source("plots/plots_priors.R")
dev.off()
### Functions  ##########################################
source("functions/functions.R")
### Violin plots ########################################
n<-c(0,6,12,18) # Efficacy example
y1<-c(0,4,8,12)
miss<-c(0,0,0,0)
y0=n-y1
p.range<-1 # temp
j<-1       # temp
stretch<-1.5
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy.png")
grid.arrange(plot1)
dev.off()
png(filename="violin_efficacy_931.png")
grid.arrange(plot1)
dev.off()
png(filename="violin_efficacy_933.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_934.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_937.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_941.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_942.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_944.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_946.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_949.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_949.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_950.png")
grid.arrange(plot1)
dev.off()
Tex('a')
TeX('a')
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_953.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_955.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
source("plots/plots_violin.R")
source("plots/plots_violin.R")
source("plots/plots_violin.R")
source("plots/plots_violin.R")
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_955.png")
grid.arrange(plot1)
dev.off()
source("plots/plots_violin.R")
source("plots/plots_violin.R")
source("plots/plots_violin.R")
plot1 <- ggplot_gtable(ggplot_build(p))
plot1$layout$clip[plot1$layout$name == "panel"] <- "off"
png(filename="violin_efficacy_955.png")
grid.arrange(plot1)
dev.off()
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES")
### Model arguments  ####################################
p.skpt<-0.40     # response rate for skeptic, enthusiast, futility
p.enth<-0.67
p.intr<-(p.skpt+p.enth)/2
tail.skpt<-0.05  # tail probabilities for priors
tail.enth<-0.05
cred.tail<-0.05
sig.fut<-0.95
sig.eff<-0.95
lambda0.skpt<-2
lambda0.enth<-2
epsilon<-0 # used to stop numerical error from integration
### Parameterize generalized normal priors  #############
source("scripts/code_headers_gen_nrml.R")
source("plots/plots_priors.R")
# Step 5: Plot Skeptical and enthuastic priors separately
## 7/19/19 match slide 14 from FDA presentation, shade in gray scale, set 350 DPI
par(ask=FALSE)
par(oma = c(1.25, 1.25, 0, 0)) # make room (i.e. the 4's) for the overall x and y axis titles
par(mar=c(5.1-1,4.1,4.1-4,2.1),mai = c(0.3, 0.3, 0.1, 0.1)) #bottom, left, top, and right.
par(mfrow = c(1, 2))
x<-seq(0,1,by=0.01)
# Make 2 boxplots
#low (skeptical)
plot(x,prior.nc.skpt(x),type="l",
xlab="",ylab="Density Value",
main="",
#xaxt="n",
yaxt="n",
ylim=c(0,2.5))
axis(2,at=c(0,1,2,3),labels=c(0,1,2,3))
polygon(c(0,x[x<=p.enth],p.enth),c(0,prior.nc.skpt(x)[x<=p.enth],0),col="lightgrey")
polygon(c(x[x>=p.enth],p.enth),c(prior.nc.skpt(x)[x>=p.enth],0),col="black")
segments(x0=p.skpt,y0=0,y1=prior.nc.skpt(p.skpt))
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES")
### Model arguments  ####################################
p.skpt<-0.40     # response rate for skeptic, enthusiast, futility
p.enth<-0.67
p.intr<-(p.skpt+p.enth)/2
tail.skpt<-0.05  # tail probabilities for priors
tail.enth<-0.05
cred.tail<-0.05
sig.fut<-0.95
sig.eff<-0.95
lambda0.skpt<-2
lambda0.enth<-2
epsilon<-0 # used to stop numerical error from integration
### Parameterize generalized normal priors  #############
source("scripts/code_headers_gen_nrml.R")
source("plots/plots_priors.R")
png(filename="prior_plots.png")
source("plots/plots_priors.R")
dev.off()
### Prior plots  ########################################
png(filename="normal_priors.png")
source("plots/plots_priors.R")
dev.off()
### Prior plots  ########################################
png(filename="normal_priors.png")
source("plots/plots_priors.R")
dev.off()
### Prior plots  ########################################
png(filename="normal_priors.png")
source("plots/plots_priors.R")
dev.off()
png(filename="normal_priors.png")
source("plots/plots_priors.R")
dev.off()
png(filename="normal_priors.png")
source("plots/plots_priors.R")
dev.off()
rm(list = ls())
setwd("D:/Users/ekwiatko/Documents/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES")
### Model arguments  ####################################
p.skpt<-0.40     # response rate for skeptic, enthusiast, futility
p.enth<-0.67
p.intr<-(p.skpt+p.enth)/2
tail.skpt<-0.05  # tail probabilities for priors
tail.enth<-0.05
cred.tail<-0.05
sig.fut<-0.95
sig.eff<-0.95
lambda0.skpt<-2
lambda0.enth<-2
epsilon<-0 # used to stop numerical error from integration
### Parameterize generalized normal priors  #############
source("scripts/code_headers_gen_nrml.R")
### Functions  ##########################################
source("functions/functions.R")
### Simulations ########################################
max.ss<-80
reps<-2000
p.range<-seq(p.skpt,p.enth,by=(p.enth-p.skpt)/5)
#p.range<-seq(p.skpt-0.05,p.enth+0.05,by=0.05)
freq.mntr<-2
#freq.mntr<-rep(c(1,2,4,8,16,76),2)     # frequency of monitoring
enr.shape<-1
#enr.shape<-c(rep(1,6),rep(0.25,6))      # shape gamma dist enrollment
out.mean<-4
#out.mean<-c(rep(4,12))       # mean normal dist outcome
source("code_main.R")
#out.mean<-c(rep(4,12))       # mean normal dist outcome
source("scripts/code_main.R")
### Sequential design properties ########################
label_main=""
stretch<-p.skpt*0.8
#pdf('spike_2019-09-18.pdf',height=6,width=15)
source("plots/plots_seq_design_prop.R")

plot(p.range,outer.eff[k,],type='l',ylim=c(0,1),lwd=2,lty='longdash',
ylab="Probability",xlab="",
main="Sequential Design Properties",
axes=FALSE)
box()
text(p.range,outer.eff[k,],
labels=format(round(outer.eff[k,],digits=2),nsmall=2),pos=3)
#lines(p.range,outer.fut.final[k,],col='red',lwd=2)
lines(p.range,outer.fut[k,],lwd=2,lty="dotted")
#text(p.range,outer.fut[k,],
#     labels=format(round(outer.fut[k,],digits=2),nsmall=2),pos=1)
#lines(p.range,outer.eff.final[k,],lwd=2)
#lines(p.range,outer.eff.final.mix[k,],lwd=2)
lines(p.range,outer.inc[k,],lwd=2)
#text(p.range,outer.inc[k,],
#     labels=format(round(outer.inc[k,],digits=2),nsmall=2),pos=1)
#lines(p.range,outer.inc.final[k,],lwd=2)
axis(1,las=0,at=p.range,labels=format(p.range,nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
abline(h=seq(0,1,by=0.1),col='grey')
abline(v=c(p.skpt,p.enth),col='grey',lty='dashed')
row<-1
for (column in 1:length(p.range)){
mtext(text=paste0(format(round(outer.ss.initial[k,column],digits=1),nsmall=1),
" + ",
format(round(outer.ss.final[k,column]-
outer.ss.initial[k,column],digits=1),nsmall=1),
" = ",
format(round(outer.ss.final[k,column],digits=1),nsmall=1)),
side=1,line=row+1,at=p.range[column])
}
row<-2
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.post.mean.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.post.mean.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
row<-3
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.cov.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.cov.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
column<-1
text(locator(1),"Stop Early for Efficacy")
text(locator(1),"Stop Early for Futility")
text(locator(1),"Inconclusive with Full Data")
# legend(x=0.325,y=0.6,
#        legend=c("Stop Early for Efficacy",
#                 "Stop Early for Futility",
#                 "Inconclusive with Full Data"),
#        lty=c('longdash','dotted','solid'),
#        cex=0.5,
#        box.lwd = 1,box.col = "black",bg = "white",pt.cex = 1,
#        text.width=20)
mtext(text="SS",side=1,line=2,at=0.125)
mtext(text="PM",side=1,line=3,at=0.125)
mtext(text="CP",side=1,line=4,at=0.125)
par(mfrow = c(1,1))
k<-1
plot(p.range,outer.eff[k,],type='l',ylim=c(0,1),lwd=2,lty='longdash',
ylab="Probability",xlab="",
main="Sequential Design Properties",
axes=FALSE)
box()
text(p.range,outer.eff[k,],
labels=format(round(outer.eff[k,],digits=2),nsmall=2),pos=3)
lines(p.range,outer.fut.final[k,],col='red',lwd=2)
lines(p.range,outer.fut[k,],lwd=2)
#text(p.range,outer.fut[k,],
#     labels=format(round(outer.fut[k,],digits=2),nsmall=2),pos=1)
lines(p.range,outer.eff.final[k,],lwd=2)
lines(p.range,outer.eff.final.mix[k,],lwd=2)
lines(p.range,outer.inc[k,],lwd=2)
#text(p.range,outer.inc[k,],
#     labels=format(round(outer.inc[k,],digits=2),nsmall=2),pos=1)
#lines(p.range,outer.inc.final[k,],lwd=2)
axis(1,las=0,at=p.range,labels=format(p.range,nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
abline(h=seq(0,1,by=0.1),col='grey')
abline(v=c(p.skpt,p.enth),col='grey',lty='dashed')
row<-1
for (column in 1:length(p.range)){
mtext(text=paste0(format(round(outer.ss.initial[k,column],digits=1),nsmall=1),
" + ",
format(round(outer.ss.final[k,column]-
outer.ss.initial[k,column],digits=1),nsmall=1),
" = ",
format(round(outer.ss.final[k,column],digits=1),nsmall=1)),
side=1,line=row+1,at=p.range[column])
}
row<-2
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.post.mean.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.post.mean.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
row<-3
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.cov.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.cov.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
column<-1
text(locator(1),"Stop Early for Efficacy")
text(locator(1),"Stop Early for Futility")
text(locator(1),"Inconclusive with Full Data")
# legend(x=0.325,y=0.6,
#        legend=c("Stop Early for Efficacy",
#                 "Stop Early for Futility",
#                 "Inconclusive with Full Data"),
#        lty=c('longdash','dotted','solid'),
#        cex=0.5,
#        box.lwd = 1,box.col = "black",bg = "white",pt.cex = 1,
#        text.width=20)
mtext(text="SS",side=1,line=2,at=0.125)
mtext(text="PM",side=1,line=3,at=0.125)
mtext(text="CP",side=1,line=4,at=0.125)
lines(p.range,outer.inc.final[k,],lwd=2)
par(mfrow = c(1,1))
k<-1
plot(p.range,outer.eff[k,],type='l',ylim=c(0,1),lwd=2,lty='longdash',
ylab="Probability",xlab="",
main="Sequential Design Properties",
axes=FALSE)
box()
text(p.range,outer.eff[k,],
labels=format(round(outer.eff[k,],digits=2),nsmall=2),pos=3)
lines(p.range,outer.fut.final[k,],lwd=2)
lines(p.range,outer.fut[k,],lwd=2,lty='longdash')
#text(p.range,outer.fut[k,],
#     labels=format(round(outer.fut[k,],digits=2),nsmall=2),pos=1)
lines(p.range,outer.eff.final[k,],lwd=2)
#lines(p.range,outer.eff.final.mix[k,],lwd=2)
lines(p.range,outer.inc[k,],lwd=2,lty='longdash')
lines(p.range,outer.inc.final[k,],lwd=2)
#text(p.range,outer.inc[k,],
#     labels=format(round(outer.inc[k,],digits=2),nsmall=2),pos=1)
axis(1,las=0,at=p.range,labels=format(p.range,nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
abline(h=seq(0,1,by=0.1),col='grey')
abline(v=c(p.skpt,p.enth),col='grey',lty='dashed')
row<-1
for (column in 1:length(p.range)){
mtext(text=paste0(format(round(outer.ss.initial[k,column],digits=1),nsmall=1),
" + ",
format(round(outer.ss.final[k,column]-
outer.ss.initial[k,column],digits=1),nsmall=1),
" = ",
format(round(outer.ss.final[k,column],digits=1),nsmall=1)),
side=1,line=row+1,at=p.range[column])
}
row<-2
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.post.mean.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.post.mean.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
row<-3
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.cov.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.cov.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
column<-1
par(mfrow = c(1,1))
k<-1
plot(p.range,outer.eff[k,],type='l',ylim=c(0,1),lwd=2,lty='longdash',
ylab="Probability",xlab="",
main="Sequential Design Properties",
axes=FALSE)
box()
text(p.range,outer.eff[k,],
labels=format(round(outer.eff[k,],digits=2),nsmall=2),pos=3)
lines(p.range,outer.fut.final[k,],lwd=2)
lines(p.range,outer.fut[k,],lwd=2,lty='longdash')
#text(p.range,outer.fut[k,],
#     labels=format(round(outer.fut[k,],digits=2),nsmall=2),pos=1)
lines(p.range,outer.eff.final[k,],lwd=2)
#lines(p.range,outer.eff.final.mix[k,],lwd=2)
lines(p.range,outer.inc[k,],lwd=2,lty='longdash')
lines(p.range,outer.inc.final[k,],lwd=2)
#text(p.range,outer.inc[k,],
#     labels=format(round(outer.inc[k,],digits=2),nsmall=2),pos=1)
axis(1,las=0,at=p.range,labels=format(p.range,nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
abline(h=seq(0,1,by=0.1),col='grey')
abline(v=c(p.skpt,p.enth),col='grey',lty='dashed')
row<-1
for (column in 1:length(p.range)){
mtext(text=paste0(format(round(outer.ss.initial[k,column],digits=1),nsmall=1),
" + ",
format(round(outer.ss.final[k,column]-
outer.ss.initial[k,column],digits=1),nsmall=1),
" = ",
format(round(outer.ss.final[k,column],digits=1),nsmall=1)),
side=1,line=row+1,at=p.range[column])
}
row<-2
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.post.mean.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.post.mean.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
row<-3
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.cov.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.cov.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
column<-1
text(locator(1),"Stop Early for Efficacy")
text(locator(1),"Final Efficacy")
text(locator(1),"Stop Early for Futility")
text(locator(1),"Final Futility")
text(locator(1),"Inconclusive")
text(locator(1),"Final Inconclusive")
# legend(x=0.325,y=0.6,
#        legend=c("Stop Early for Efficacy",
#                 "Stop Early for Futility",
#                 "Inconclusive with Full Data"),
#        lty=c('longdash','dotted','solid'),
#        cex=0.5,
#        box.lwd = 1,box.col = "black",bg = "white",pt.cex = 1,
#        text.width=20)
mtext(text="SS",side=1,line=2,at=0.125)
mtext(text="PM",side=1,line=3,at=0.125)
mtext(text="CP",side=1,line=4,at=0.125)
par(mfrow = c(1,1))
k<-1
plot(p.range,outer.eff[k,],type='l',ylim=c(0,1),lwd=2,lty='longdash',
ylab="Probability",xlab="",
main="Sequential Design Properties",
axes=FALSE)
box()
text(p.range,outer.eff[k,],
labels=format(round(outer.eff[k,],digits=2),nsmall=2),pos=3)
lines(p.range,outer.fut.final[k,],lwd=2)
lines(p.range,outer.fut[k,],lwd=2,lty='longdash')
#text(p.range,outer.fut[k,],
#     labels=format(round(outer.fut[k,],digits=2),nsmall=2),pos=1)
lines(p.range,outer.eff.final[k,],lwd=2)
#lines(p.range,outer.eff.final.mix[k,],lwd=2)
lines(p.range,outer.inc[k,],lwd=2,lty='longdash')
lines(p.range,outer.inc.final[k,],lwd=2)
#text(p.range,outer.inc[k,],
#     labels=format(round(outer.inc[k,],digits=2),nsmall=2),pos=1)
axis(1,las=0,at=p.range,labels=format(p.range,nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
abline(h=seq(0,1,by=0.1),col='grey')
abline(v=c(p.skpt,p.enth),col='grey',lty='dashed')
row<-1
for (column in 1:length(p.range)){
mtext(text=paste0(format(round(outer.ss.initial[k,column],digits=1),nsmall=1),
" + ",
format(round(outer.ss.final[k,column]-
outer.ss.initial[k,column],digits=1),nsmall=1),
" = ",
format(round(outer.ss.final[k,column],digits=1),nsmall=1)),
side=1,line=row+1,at=p.range[column])
}
row<-2
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.post.mean.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.post.mean.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
row<-3
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.cov.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.cov.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
column<-1
text(locator(1),"Stop Early for Efficacy")
text(locator(1),"Final Efficacy")
text(locator(1),"Stop Early for Futility")
text(locator(1),"Final Futility")
text(locator(1),"Inconclusive")
text(locator(1),"Final Inconclusive")
# legend(x=0.325,y=0.6,
#        legend=c("Stop Early for Efficacy",
#                 "Stop Early for Futility",
#                 "Inconclusive with Full Data"),
#        lty=c('longdash','dotted','solid'),
#        cex=0.5,
#        box.lwd = 1,box.col = "black",bg = "white",pt.cex = 1,
#        text.width=20)
mtext(text="SS",side=1,line=2,at=0.125)
mtext(text="PM",side=1,line=3,at=0.125)
mtext(text="CP",side=1,line=4,at=0.125)
par(mfrow = c(1,1))
k<-1
plot(p.range,outer.eff[k,],type='l',ylim=c(0,1),lwd=2,lty='longdash',
ylab="Probability",xlab="",
main="Sequential Design Properties",
axes=FALSE)
box()
text(p.range,outer.eff[k,],
labels=format(round(outer.eff[k,],digits=2),nsmall=2),pos=3)
lines(p.range,outer.fut.final[k,],lwd=2)
lines(p.range,outer.fut[k,],lwd=2,lty='longdash')
#text(p.range,outer.fut[k,],
#     labels=format(round(outer.fut[k,],digits=2),nsmall=2),pos=1)
lines(p.range,outer.eff.final[k,],lwd=2)
#lines(p.range,outer.eff.final.mix[k,],lwd=2)
lines(p.range,outer.inc[k,],lwd=2,lty='longdash')
lines(p.range,outer.inc.final[k,],lwd=2)
#text(p.range,outer.inc[k,],
#     labels=format(round(outer.inc[k,],digits=2),nsmall=2),pos=1)
axis(1,las=0,at=p.range,labels=format(p.range,nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
abline(h=seq(0,1,by=0.1),col='grey')
abline(v=c(p.skpt,p.enth),col='grey',lty='dashed')
row<-1
for (column in 1:length(p.range)){
mtext(text=paste0(format(round(outer.ss.initial[k,column],digits=1),nsmall=1),
" + ",
format(round(outer.ss.final[k,column]-
outer.ss.initial[k,column],digits=1),nsmall=1),
" = ",
format(round(outer.ss.final[k,column],digits=1),nsmall=1)),
side=1,line=row+1,at=p.range[column])
}
row<-2
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.post.mean.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.post.mean.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
row<-3
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.cov.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.cov.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
column<-1
text(locator(1),"Stop Early for Efficacy")
text(locator(1),"Final Efficacy")
text(locator(1),"Stop Early for Futility")
text(locator(1),"Final Futility")
text(locator(1),"Inconclusive")
text(locator(1),"Final Inconclusive")
# legend(x=0.325,y=0.6,
#        legend=c("Stop Early for Efficacy",
#                 "Stop Early for Futility",
#                 "Inconclusive with Full Data"),
#        lty=c('longdash','dotted','solid'),
#        cex=0.5,
#        box.lwd = 1,box.col = "black",bg = "white",pt.cex = 1,
#        text.width=20)
mtext(text="SS",side=1,line=2,at=0.125)
mtext(text="PM",side=1,line=3,at=0.125)
mtext(text="CP",side=1,line=4,at=0.125)
par(mfrow = c(1,1))
k<-1
plot(p.range,outer.eff[k,],type='l',ylim=c(0,1),lwd=2,lty='longdash',
ylab="Probability",xlab="",
main="Sequential Design Properties",
axes=FALSE)
box()
text(p.range,outer.eff[k,],
labels=format(round(outer.eff[k,],digits=2),nsmall=2),pos=3)
lines(p.range,outer.fut.final[k,],lwd=2)
lines(p.range,outer.fut[k,],lwd=2,lty='longdash')
#text(p.range,outer.fut[k,],
#     labels=format(round(outer.fut[k,],digits=2),nsmall=2),pos=1)
lines(p.range,outer.eff.final[k,],lwd=2)
#lines(p.range,outer.eff.final.mix[k,],lwd=2)
lines(p.range,outer.inc[k,],lwd=2,lty='longdash')
lines(p.range,outer.inc.final[k,],lwd=2)
#text(p.range,outer.inc[k,],
#     labels=format(round(outer.inc[k,],digits=2),nsmall=2),pos=1)
axis(1,las=0,at=p.range,labels=format(p.range,nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
abline(h=seq(0,1,by=0.1),col='grey')
abline(v=c(p.skpt,p.enth),col='grey',lty='dashed')
row<-1
for (column in 1:length(p.range)){
mtext(text=paste0(format(round(outer.ss.initial[k,column],digits=1),nsmall=1),
" + ",
format(round(outer.ss.final[k,column]-
outer.ss.initial[k,column],digits=1),nsmall=1),
" = ",
format(round(outer.ss.final[k,column],digits=1),nsmall=1)),
side=1,line=row+1,at=p.range[column])
}
row<-2
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.post.mean.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.post.mean.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
row<-3
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.cov.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.cov.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
column<-1
text(locator(1),"Stop Early for Efficacy")
text(locator(1),"Final Efficacy")
text(locator(1),"Stop Early for Futility")
text(locator(1),"Final Futility")
text(locator(1),"Inconclusive")
text(locator(1),"Final Inconclusive")
# legend(x=0.325,y=0.6,
#        legend=c("Stop Early for Efficacy",
#                 "Stop Early for Futility",
#                 "Inconclusive with Full Data"),
#        lty=c('longdash','dotted','solid'),
#        cex=0.5,
#        box.lwd = 1,box.col = "black",bg = "white",pt.cex = 1,
#        text.width=20)
mtext(text="SS",side=1,line=2,at=0.125)
mtext(text="PM",side=1,line=3,at=0.125)
mtext(text="CP",side=1,line=4,at=0.125)
par(mfrow = c(1,1))
k<-1
plot(p.range,outer.eff[k,],type='l',ylim=c(0,1),lwd=2,lty='longdash',
ylab="Probability",xlab="",
main="Sequential Design Properties",
axes=FALSE)
box()
text(p.range,outer.eff[k,],
labels=format(round(outer.eff[k,],digits=2),nsmall=2),pos=3)
lines(p.range,outer.fut.final[k,],lwd=2)
lines(p.range,outer.fut[k,],lwd=2,lty='longdash')
#text(p.range,outer.fut[k,],
#     labels=format(round(outer.fut[k,],digits=2),nsmall=2),pos=1)
lines(p.range,outer.eff.final[k,],lwd=2)
#lines(p.range,outer.eff.final.mix[k,],lwd=2)
lines(p.range,outer.inc[k,],lwd=2,lty='longdash')
lines(p.range,outer.inc.final[k,],lwd=2)
#text(p.range,outer.inc[k,],
#     labels=format(round(outer.inc[k,],digits=2),nsmall=2),pos=1)
axis(1,las=0,at=p.range,labels=format(p.range,nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
abline(h=seq(0,1,by=0.1),col='grey')
abline(v=c(p.skpt,p.enth),col='grey',lty='dashed')
row<-1
for (column in 1:length(p.range)){
mtext(text=paste0(format(round(outer.ss.initial[k,column],digits=1),nsmall=1),
" + ",
format(round(outer.ss.final[k,column]-
outer.ss.initial[k,column],digits=1),nsmall=1),
" = ",
format(round(outer.ss.final[k,column],digits=1),nsmall=1)),
side=1,line=row+1,at=p.range[column])
}
row<-2
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.post.mean.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.post.mean.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
row<-3
for (column in 1:length(p.range)){
mtext(text=paste0("(I) ",
format(round(outer.cov.initial[k,column],digits=3),nsmall=3),
" (F) ",
format(round(outer.cov.final[k,column],digits=3),nsmall=3)),
side=1,line=row+1,at=p.range[column])
}
column<-1
text(locator(1),"Stop Early for Efficacy")
text(locator(1),"Final Efficacy")
text(locator(1),"Stop Early for Futility")
text(locator(1),"Final Futility")
text(locator(1),"Inconclusive")
text(locator(1),"Final Inconclusive")
# legend(x=0.325,y=0.6,
#        legend=c("Stop Early for Efficacy",
#                 "Stop Early for Futility",
#                 "Inconclusive with Full Data"),
#        lty=c('longdash','dotted','solid'),
#        cex=0.5,
#        box.lwd = 1,box.col = "black",bg = "white",pt.cex = 1,
#        text.width=20)
mtext(text="SS",side=1,line=2,at=0.125)
mtext(text="PM",side=1,line=3,at=0.125)
mtext(text="CP",side=1,line=4,at=0.125)

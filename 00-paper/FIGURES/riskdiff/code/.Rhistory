delta
delta.enth
delta.skpt
lambda0.enth
lambda0.skpt
lambda0.enth
lambda0.placebo
#########################################
rm(list = ls())
root<-"P:/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/riskdiff/code"
setwd(root)
require(rmutil)
require(lattice)
require(pracma)
source("code_functions.R")
source("args_model.R")
prior.placebo.nc<-fcn_prior_placebo()
prior.skpt.nc<-skpt_tail_area()
prior.enth.nc<-enth_tail_area()
x
plot(x,prior.placebo.nc(x))
prior.placebo.nc<-fcn_prior_placebo()
x<-seq(0,1,length=1000)
plot(x,prior.placebo.nc(x))
plot(x,prior.placebo.nc(x),type='l')
x <- seq(0,1,length.out=100)
y <- seq(0,1,length.out=100)
z <- outer(x^2,y^2,`+`)
z
z <- prior.skpt.nc(x,y)
z
persp(x,y,z, col='blue')
z
prior.skpt.nc
prior.skpt.nc<-skpt_tail_area()
wireframe(z, drape=T, col.regions=rainbow(100))
prior.skpt.nc<-skpt_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.skpt.nc)
wireframe(z, drape=T, col.regions=rainbow(100))
prior.enth.nc<-enth_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.enth.nc)
wireframe(z, drape=T, col.regions=rainbow(100))
set.seed(1)
data <- data.frame(V1=sample(1:10,100,replace=TRUE),V2=sample(1:10,100,replace=TRUE))
foo <- table(data)
heatmap(foo,Rowv=NA,Colv=NA)
data
heatmap(z)
heatmap(z,Rowv=NA,Colv=NA)
prior.enth.nc<-enth_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.enth.nc)
wireframe(z, drape=T, col.regions=rainbow(100))
heatmap(z,Rowv=NA,Colv=NA)
prior.skpt.nc<-skpt_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.skpt.nc)
#wireframe(z, drape=T, col.regions=rainbow(100))
heatmap(z,Rowv=NA,Colv=NA)
library(spatstat)
install.packages(spatstat)
install.packages('spatstat'')
)
3
s
()
)
d
b
3_3
3+3
''
install.packages('spatstat')
require(rmutil)
require(lattice)
require(pracma)
require(spatstat)
source("code_functions.R")
source("args_model.R")
prior.placebo.nc<-fcn_prior_placebo()
x<-seq(0,1,length=1000)
plot(x,prior.placebo.nc(x),type='l')
prior.skpt.nc<-skpt_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.skpt.nc)
#wireframe(z, drape=T, col.regions=rainbow(100))
heatmap(z,Rowv=NA,Colv=NA)
set.seed(3)
X <- rpoispp(10)
par(mfrow = c(2,2))
plot(density(X, 1))
plot(density(X, 0.1))
plot(density(X, 0.05))
plot(density(X, 0.01))
X
rpoispp(10)
density(X, 1)
#wireframe(z, drape=T, col.regions=rainbow(100))
#heatmap(z,Rowv=NA,Colv=NA)
plot(density(z))
?density
require(graphics)
plot(density(c(-20, rep(0,98), 20)), xlim = c(-4, 4))  # IQR = 0
plot(density(c(-20, rep(0,98), 20)), xlim = c(-4, 4))  # IQR = 0
prior.enth.nc<-enth_tail_area()
X <- rpoispp(10)
par(mfrow = c(2,2))
plot(density(X, 1))
plot(density(X, 0.1))
plot(density(X, 0.05))
plot(density(X, 0.01))
X
data.frame(X)
density(X,1)
data.frame(density(X,1))
head(data.frame(density(X,1)))
evan<-(data.frame(density(X,1)))
table(evan$optional)
z
head(z)
outer(x,y)
cross(x,y)
expand.grid(x,y)
xy<-expand.grid(x,y)
z<-prior.skpt.nc(xy$Var1,xy$Var2)
z
X<-cbind(xy,z)
head(X)
names(X)<-c("x","y","value")
density(X, 1)
head(evan)
plot(density(X))
X$x
X
density(X, 1)
set.seed(3)
X <- rpoispp(10)
par(mfrow = c(2,2))
plot(density(X, 1))
plot(density(X, 0.1))
plot(density(X, 0.05))
plot(density(X, 0.01))
density(X, 1)
?density
X
X <- rpoispp(10)
X
X$trype
X$type
X$xrange
X[[type]]
X[ttype.convert()
]
?density
#wireframe(z, drape=T, col.regions=rainbow(100))
heatmap(z,Rowv=NA,Colv=NA)
prior.skpt.nc<-skpt_tail_area()
x <- seq(0, 1, length= 100)
y <- x
#xy<-expand.grid(x,y)
z<-prior.skpt.nc(xy$Var1,xy$Var2)
heatmap(z,Rowv=NA,Colv=NA)
z <- outer(x, y, prior.skpt.nc)
heatmap(z,Rowv=NA,Colv=NA)
z
max(z)
which(max(z))
z(0,0)
prior.skpt.nc(0,0)
prior.skpt.nc(0,1)
prior.skpt.nc(0.5,0.5)
prior.skpt.nc(0.39,0.39)
prior.skpt.nc(0.39,0)
prior.skpt.nc(1,1)
wireframe(z, drape=T, col.regions=rainbow(100))
prior.enth.nc<-enth_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.enth.nc)
wireframe(z, drape=T, col.regions=rainbow(100))
#########################################
#### Figure 5, Risk Diff Prior Plots ####
#########################################
rm(list = ls())
root<-"P:/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/riskdiff/code"
setwd(root)
require(rmutil)
require(lattice)
require(pracma)
require(spatstat)
source("code_functions.R")
source("args_model.R")
prior.placebo.nc<-fcn_prior_placebo()
x<-seq(0,1,length=1000)
png('../../figure5a.png')
par(mfrow = c(1,1))
plot(x,prior.placebo.nc(x),type='l')
dev.off()
prior.skpt.nc<-skpt_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.skpt.nc)
#heatmap(z,Rowv=NA,Colv=NA)
png('../../figure5b.png')
par(mfrow = c(1,1))
wireframe(z, drape=T, col.regions=rainbow(100))
dev.off()
prior.enth.nc<-enth_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.enth.nc)
#heatmap(z,Rowv=NA,Colv=NA)
png('../../figure5c.png')
par(mfrow = c(1,1))
wireframe(z, drape=T, col.regions=rainbow(100))
dev.off()
#############################################
#### Figure 6, Risk Diff Inference Plots ####
#############################################
rm(list = ls())
root<-"P:\GitHub\Bayesian-Sequential-Monitoring\00-paper\FIGURES\riskdiff\code"
setwd(root)
source("args_model.R")
args_simulation<-read.csv(file="args_simulation.csv",header=TRUE,sep=",")
Table1<-read.csv(file="../output/Table1_merged.csv",header=TRUE,sep=",")
combined1<-merge(args_simulation,Table1,by.x="X",by.y="idx")
figure3<-combined1
par(mar=c(5.1,4.1,2.1,2.1))
plot(figure3$p.IP,figure3$inference0,type='l',
ylim=c(0,1),
ylab="",
xlab="",
main="",
axes=FALSE)
abline(h=seq(0,1,by=0.1),col='grey')
box()
lines(figure3$p.IP,figure3$inference0)
lines(figure3$p.IP,figure3$inference25)
lines(figure3$p.IP,figure3$inference50)
lines(figure3$p.IP,figure3$inference75)
lines(figure3$p.IP,figure3$inference100)
axis(1,las=0,at=figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],
labels=format(figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
rm(list = ls())
root<-"P:\GitHub\Bayesian-Sequential-Monitoring\00-paper\FIGURES\riskdiff\code"
setwd(root)
source("args_model.R")
args_simulation<-read.csv(file="args_simulation.csv",header=TRUE,sep=",")
Table1<-read.csv(file="../output/Table1_merged.csv",header=TRUE,sep=",")
combined1<-merge(args_simulation,Table1,by.x="X",by.y="idx")
figure3<-combined1
par(mar=c(5.1,4.1,2.1,2.1))
par(mfrow = c(1,1))
plot(figure3$p.IP,figure3$inference0,type='l',
ylim=c(0,1),
ylab="",
xlab="",
main="",
axes=FALSE)
abline(h=seq(0,1,by=0.1),col='grey')
box()
lines(figure3$p.IP,figure3$inference0)
lines(figure3$p.IP,figure3$inference25)
lines(figure3$p.IP,figure3$inference50)
lines(figure3$p.IP,figure3$inference75)
lines(figure3$p.IP,figure3$inference100)
axis(1,las=0,at=figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],
labels=format(figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
#########################################
#### Figure 5, Risk Diff Prior Plots ####
#########################################
rm(list = ls())
root<-"P:/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/riskdiff/code"
setwd(root)
require(rmutil)
require(lattice)
require(pracma)
require(spatstat)
source("code_functions.R")
source("args_model.R")
prior.placebo.nc<-fcn_prior_placebo()
x<-seq(0,1,length=1000)
png('../../figure5a.png')
par(mfrow = c(1,1))
plot(x,prior.placebo.nc(x),type='l')
dev.off()
prior.skpt.nc<-skpt_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.skpt.nc)
#heatmap(z,Rowv=NA,Colv=NA)
png('../../figure5b.png')
par(mfrow = c(1,1))
wireframe(z, drape=T, col.regions=rainbow(100))
dev.off()
prior.enth.nc<-enth_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.enth.nc)
#heatmap(z,Rowv=NA,Colv=NA)
png('../../figure5c.png')
par(mfrow = c(1,1))
wireframe(z, drape=T, col.regions=rainbow(100))
dev.off()
#############################################
#### Figure 6, Risk Diff Inference Plots ####
#############################################
rm(list = ls())
root<-"P:\GitHub\Bayesian-Sequential-Monitoring\00-paper\FIGURES\riskdiff\code"
setwd(root)
source("args_model.R")
args_simulation<-read.csv(file="args_simulation.csv",header=TRUE,sep=",")
Table1<-read.csv(file="../output/Table1_merged.csv",header=TRUE,sep=",")
combined1<-merge(args_simulation,Table1,by.x="X",by.y="idx")
figure3<-combined1
par(mar=c(5.1,4.1,2.1,2.1))
par(mfrow = c(1,1))
plot(figure3$p.IP,figure3$inference0,type='l',
ylim=c(0,1),
ylab="",
xlab="",
main="",
axes=FALSE)
abline(h=seq(0,1,by=0.1),col='grey')
box()
lines(figure3$p.IP,figure3$inference0)
lines(figure3$p.IP,figure3$inference25)
lines(figure3$p.IP,figure3$inference50)
#lines(figure3$p.IP,figure3$inference75)
#lines(figure3$p.IP,figure3$inference100)
axis(1,las=0,at=figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],
labels=format(figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
rm(list = ls())
root<-"P:\GitHub\Bayesian-Sequential-Monitoring\00-paper\FIGURES\riskdiff\code"
setwd(root)
source("args_model.R")
args_simulation<-read.csv(file="args_simulation.csv",header=TRUE,sep=",")
Table1<-read.csv(file="../output/Table1_merged.csv",header=TRUE,sep=",")
combined1<-merge(args_simulation,Table1,by.x="X",by.y="idx")
figure3<-combined1
par(mar=c(5.1,4.1,2.1,2.1))
par(mfrow = c(1,1))
plot(figure3$p.IP,figure3$inference0,type='l',
ylim=c(0,0.3),
ylab="",
xlab="",
main="",
axes=FALSE)
abline(h=seq(0,0.3,by=0.1),col='grey')
box()
lines(figure3$p.IP,figure3$inference0)
lines(figure3$p.IP,figure3$inference25)
lines(figure3$p.IP,figure3$inference50)
#lines(figure3$p.IP,figure3$inference75)
#lines(figure3$p.IP,figure3$inference100)
axis(1,las=0,at=figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],
labels=format(figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
png('../../figure6.png')
par(mfrow = c(1,1))
plot(figure3$p.IP,figure3$inference0,type='l',
ylim=c(0,0.3),
ylab="",
xlab="",
main="",
axes=FALSE)
abline(h=seq(0,0.3,by=0.1),col='grey')
box()
lines(figure3$p.IP,figure3$inference0)
lines(figure3$p.IP,figure3$inference25)
lines(figure3$p.IP,figure3$inference50)
#lines(figure3$p.IP,figure3$inference75)
#lines(figure3$p.IP,figure3$inference100)
axis(1,las=0,at=figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],
labels=format(figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
dev.off()
#########################################
#### Figure 5, Risk Diff Prior Plots ####
#########################################
rm(list = ls())
root<-"P:/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/riskdiff/code"
setwd(root)
require(rmutil)
require(lattice)
require(pracma)
require(spatstat)
source("code_functions.R")
source("args_model.R")
prior.placebo.nc<-fcn_prior_placebo()
x<-seq(0,1,length=1000)
png('../../figure5a.png')
par(mfrow = c(1,1))
plot(x,prior.placebo.nc(x),type='l')
dev.off()
prior.skpt.nc<-skpt_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.skpt.nc)
#heatmap(z,Rowv=NA,Colv=NA)
png('../../figure5b.png')
par(mfrow = c(1,1))
wireframe(z, drape=T, col.regions=rainbow(100))
dev.off()
prior.enth.nc<-enth_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.enth.nc)
#heatmap(z,Rowv=NA,Colv=NA)
png('../../figure5c.png')
par(mfrow = c(1,1))
wireframe(z, drape=T, col.regions=rainbow(100))
dev.off()
#############################################
#### Figure 6, Risk Diff Inference Plots ####
#############################################
rm(list = ls())
root<-"P:\GitHub\Bayesian-Sequential-Monitoring\00-paper\FIGURES\riskdiff\code"
setwd(root)
source("args_model.R")
args_simulation<-read.csv(file="args_simulation.csv",header=TRUE,sep=",")
Table1<-read.csv(file="../output/Table1_merged.csv",header=TRUE,sep=",")
combined1<-merge(args_simulation,Table1,by.x="X",by.y="idx")
figure3<-combined1
par(mar=c(5.1,4.1,2.1,2.1))
par(mfrow = c(1,1))
png('../../figure6.png')
par(mfrow = c(1,1))
plot(figure3$p.IP,figure3$inference0,type='l',
ylim=c(0,0.3),
ylab="",
xlab="",
main="",
axes=FALSE)
abline(h=seq(0,0.3,by=0.1),col='grey')
box()
lines(figure3$p.IP,figure3$inference0)
lines(figure3$p.IP,figure3$inference25)
lines(figure3$p.IP,figure3$inference50)
#lines(figure3$p.IP,figure3$inference75)
#lines(figure3$p.IP,figure3$inference100)
axis(1,las=0,at=figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],
labels=format(figure3$p.IP[seq(1,length(figure3$p.IP),by=3)],nsmall=2))
axis(2,las=2,at=seq(0,1,by=0.1),labels=format(seq(0,1,by=0.1),nsmall=1))
dev.off()
#######################################
#### Figure 1, One Arm Prior Plots ####
#######################################
rm(list = ls())
root<-"P:/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/onearm/code"
setwd(root)
source("code_functions.R")
source("args_model.R")
png('../../figure1.png')
par(mfrow = c(2,2)) #c(bottom, left, top, right)
prior.nc.skpt<-skpt_prior_default()
source("plots/plots_prior_skpt.R")
prior.nc.skpt<-skpt_prior_custom(scale=1.15)
source("plots/plots_prior_skpt.R")
prior.nc.enth<-enth_prior_default()
source("plots/plots_prior_enth.R")
prior.nc.enth<-enth_prior_custom(scale=0.85)
source("plots/plots_prior_enth.R")
dev.off()
#########################################
#### Figure 5, Risk Diff Prior Plots ####
#########################################
rm(list = ls())
root<-"P:/GitHub/Bayesian-Sequential-Monitoring/00-paper/FIGURES/riskdiff/code"
setwd(root)
require(rmutil)
require(lattice)
require(pracma)
require(spatstat)
source("code_functions.R")
source("args_model.R")
prior.placebo.nc<-fcn_prior_placebo()
x<-seq(0,1,length=1000)
png('../../figure5a.png')
par(mfrow = c(1,1))
plot(x,prior.placebo.nc(x),type='l')
dev.off()
prior.skpt.nc<-skpt_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.skpt.nc)
#heatmap(z,Rowv=NA,Colv=NA)
png('../../figure5b.png')
par(mfrow = c(1,1))
wireframe(z, drape=T, col.regions=rainbow(100))
dev.off()
prior.enth.nc<-enth_tail_area()
x <- seq(0, 1, length= 100)
y <- x
z <- outer(x, y, prior.enth.nc)
#heatmap(z,Rowv=NA,Colv=NA)
png('../../figure5c.png')
par(mfrow = c(1,1))
wireframe(z, drape=T, col.regions=rainbow(100))
dev.off()
sigma0.placebo
lambda0.placebo

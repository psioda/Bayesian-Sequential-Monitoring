1,   # enr.shape
4,   # out.mean
0,   # fut.mix.prob
c(seq(1, 0.25, by = -0.25)), # eff.mix.prob
0.5,  # inf.mix.prob
0.05, # cred.tail
100,  # max.ss
70,   # min.ss
1)   # reps
simulation2 <- expand.grid(
seq(.39, 0.63, length = 5), # p.IP
.39, # p.PC
2,   # freq.mntr
1,   # enr.shape
4,   # out.mean
0,   # fut.mix.prob
10, # eff.mix.prob
0.5,  # inf.mix.prob
0.05, # cred.tail
100,  # max.ss
70,   # min.ss
1)   # reps
simulation <- rbind(simulation1, simulation2)
simulation
#####################################
# Simulation parameters
# Evan Kwiatkowski, Feb 23, 2020
#
# The (fut|eff).mix.prob weights are
# assigned to the SKEPTICAL component
#####################################
rm(list = ls())
# simulation1 <- expand.grid(
#   seq(.39, 0.63, length = 5), # p.IP
#   .39, # p.PC
#   2,   # freq.mntr
#   1,   # enr.shape
#   4,   # out.mean
#   0,   # fut.mix.prob
#   c(seq(1, 0.25, by = -0.25)), # eff.mix.prob
#   0.5,  # inf.mix.prob
#   0.05, # cred.tail
#   100,  # max.ss
#   70,   # min.ss
#   10000)   # reps
#
# simulation2 <- expand.grid(
#   seq(.39, 0.63, length = 5), # p.IP
#   .39, # p.PC
#   2,   # freq.mntr
#   1,   # enr.shape
#   4,   # out.mean
#   0,   # fut.mix.prob
#   rep(10,156), # eff.mix.prob
#   0.5,  # inf.mix.prob
#   0.05, # cred.tail
#   100,  # max.ss
#   70,   # min.ss
#   65)   # reps
#
# simulation <- rbind(simulation1, simulation2)
simulation1 <- expand.grid(
seq(.39, 0.63, length = 5), # p.IP
.39, # p.PC
2,   # freq.mntr
1,   # enr.shape
4,   # out.mean
0,   # fut.mix.prob
c(seq(1, 0.25, by = -0.25)), # eff.mix.prob
0.5,  # inf.mix.prob
0.05, # cred.tail
100,  # max.ss
70,   # min.ss
1)   # reps
simulation2 <- expand.grid(
seq(.39, 0.63, length = 5), # p.IP
.39, # p.PC
2,   # freq.mntr
1,   # enr.shape
4,   # out.mean
0,   # fut.mix.prob
10, # eff.mix.prob
0.5,  # inf.mix.prob
0.05, # cred.tail
100,  # max.ss
70,   # min.ss
1)   # reps
simulation <- rbind(simulation1, simulation2)
names(simulation) <- c(
"p.IP",
"p.PC",
"freq.mntr",
"enr.shape",
"out.mean",
"fut.mix.prob",
"eff.mix.prob",
"inf.mix.prob",
"cred.tail",
"max.ss",
"min.ss",
"reps")
write.csv(x    = simulation, file = "args_simulation.csv")
Table0  <- read.csv("../../output/Table0_merged.csv")
getwd()
Table0  <- read.csv("../../output/Table0_merged.csv")
View(Table0)
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
plot(Table0$risk.diff.initial, Table0$box.skpt.initial, type = 'l')
plot(Table0$risk.diff.initial, Table0$box.enth.initial, type = 'l')
plot(Table0$risk.diff.initial, Table0$box.skpt.initial, type = 'l')
lines(Table0$risk.diff.initial, Table0$box.enth.initial)
#####################################
# Simulation parameters
# Evan Kwiatkowski, Feb 23, 2020
#
# The (fut|eff).mix.prob weights are
# assigned to the SKEPTICAL component
#####################################
rm(list = ls())
# simulation1 <- expand.grid(
#   seq(.39, 0.63, length = 5), # p.IP
#   .39, # p.PC
#   2,   # freq.mntr
#   1,   # enr.shape
#   4,   # out.mean
#   0,   # fut.mix.prob
#   c(seq(1, 0.25, by = -0.25)), # eff.mix.prob
#   0.5,  # inf.mix.prob
#   0.05, # cred.tail
#   100,  # max.ss
#   70,   # min.ss
#   10000)   # reps
#
# simulation2 <- expand.grid(
#   seq(.39, 0.63, length = 5), # p.IP
#   .39, # p.PC
#   2,   # freq.mntr
#   1,   # enr.shape
#   4,   # out.mean
#   0,   # fut.mix.prob
#   rep(10,156), # eff.mix.prob
#   0.5,  # inf.mix.prob
#   0.05, # cred.tail
#   100,  # max.ss
#   70,   # min.ss
#   65)   # reps
#
# simulation <- rbind(simulation1, simulation2)
simulation1 <- expand.grid(
seq(.39, 0.63, length = 5), # p.IP
.39, # p.PC
2,   # freq.mntr
1,   # enr.shape
4,   # out.mean
0,   # fut.mix.prob
c(seq(1, 0.25, by = -0.25)), # eff.mix.prob
0.5,  # inf.mix.prob
0.05, # cred.tail
100,  # max.ss
70,   # min.ss
1)   # reps
simulation2 <- expand.grid(
seq(.39, 0.63, length = 5), # p.IP
.39, # p.PC
15,   # freq.mntr
1,   # enr.shape
4,   # out.mean
0,   # fut.mix.prob
10, # eff.mix.prob
0.5,  # inf.mix.prob
0.05, # cred.tail
100,  # max.ss
70,   # min.ss
20)   # reps
simulation <- rbind(simulation1, simulation2)
names(simulation) <- c(
"p.IP",
"p.PC",
"freq.mntr",
"enr.shape",
"out.mean",
"fut.mix.prob",
"eff.mix.prob",
"inf.mix.prob",
"cred.tail",
"max.ss",
"min.ss",
"reps")
write.csv(x    = simulation, file = "args_simulation.csv")
plot(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$box.skpt.initial,Table0$box.skpt.final), type = 'l')
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
plot(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$box.skpt.initial,Table0$box.skpt.final), type = 'l')
c(Table0$risk.diff.initial,Table0$risk.diff.final)
c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$box.skpt.initial,Table0$box.skpt.final))
lines(Table0$risk.diff.initial, Table0$box.enth.initial)
plot(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$box.skpt.initial,Table0$box.skpt.final))
points(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$enth.skpt.initial,Table0$box.enth.final))
points(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$box.enth.initial,Table0$box.enth.final))
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
Table0
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
plot(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$box.skpt.initial,Table0$box.skpt.final))
lines(lowess(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$box.skpt.initial,Table0$box.skpt.final)))
points(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$box.enth.initial,Table0$box.enth.final))
lines(lowess(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$box.enth.initial,Table0$box.enth.final)))
library(MASS)
data(iris)
## univariate example
fhat <- kde(x=iris[,2])
library(ks)
data(iris)
## univariate example
fhat <- kde(x=iris[,2])
plot(fhat, cont=50, col.cont="blue", cont.lwd=2, xlab="Sepal length")
plot(c(Table0$risk.diff.initial,Table0$risk.diff.final), c(Table0$box.skpt.initial,Table0$box.skpt.final))
## bivariate example
fhat <- kde(x=iris[,2:3])
plot(fhat, display="filled.contour2", cont=seq(10,90,by=10))
plot(fhat, display="persp", thin=3, border=1, col="white")
iris[,2:3]
plot(fhat)
x_length <- 50
nspecies <- 25
sim_data <- sim.curves(nspecies = nspecies,x_length = x_length)
x <- runif(300,  min=-10, max=10)
y <- 0.1*x^3 - 0.5 * x^2 - x + 10 + rnorm(length(x),0,8)
# plot of x and y :
plot(x,y,col=rgb(0.4,0.4,0.8,0.6),pch=16 , cex=1.3)
# Can we find a polynome that fit this function ?
model <- lm(y ~ x + I(x^2) + I(x^3))
# For each value of x, I can get the value of y estimated by the model, and add it to the current plot !
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
plot(x, y)
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y)
model <- lm(y ~ x + I(x^2) + I(x^3))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y, col=2)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
plot(x, y, xlab = "Observed Response Difference", "Box's p-value")
plot(x, y, xlab = "Observed Response Difference", ylab = "Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y, col=2)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y, xlab = "Observed Response Difference", ylab = "Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y, col=2)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
par(mfrow=c(1,2))
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y, xlab = "Observed Response Difference", ylab = "Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y, col=2)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
y1 <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
y2 <- c(Table0$box.enth.initial,Table0$box.enth.final)
y1-y2
summary(y1-y2)
plot(x, y1-y2)
par(mfrow=c(1,2))
plot(x, y2-y1)
par(mfrow=c(1,2))
plot(x, y2-y1)
plot(x, 1-(y2-y1))
plot(x, y2-y1)
y1 <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
y2 <- c(Table0$box.enth.initial,Table0$box.enth.final)
y  <- y2 - y1
plot(x, y2-y1)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
plot(x, y2-y1, x = "Observed Risk Difference", ylab = "Difference in Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
par(mfrow=c(1,2))
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y, xlab = "Observed Response Difference", ylab = "Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y, col=2)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
y1 <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
y2 <- c(Table0$box.enth.initial,Table0$box.enth.final)
y  <- y2 - y1
plot(x, y2-y1, x = "Observed Risk Difference", ylab = "Difference in Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
par(mfrow=c(1,2))
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y, xlab = "Observed Response Difference", ylab = "Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y, col=2)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
y1 <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
y2 <- c(Table0$box.enth.initial,Table0$box.enth.final)
y  <- y2 - y1
plot(x, y, x = "Observed Risk Difference", ylab = "Difference in Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
x
y
length(x)
length(y)
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
par(mfrow=c(1,2))
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y, xlab = "Observed Response Difference", ylab = "Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y, col=2)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
y1 <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
y2 <- c(Table0$box.enth.initial,Table0$box.enth.final)
y  <- y2 - y1
plot(x, y, xlab = "Observed Risk Difference", ylab = "Difference in Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
abline(v=0)
abline(v=0, col="grey")
abline(v=0.12, col="grey")
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
par(mfrow=c(1,2))
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y, xlab = "Observed Response Difference", ylab = "Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y, col=2)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
abline(v=0, col="grey")
abline(v=0.12, col="grey")
y1 <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
y2 <- c(Table0$box.enth.initial,Table0$box.enth.final)
y  <- y2 - y1
plot(x, y, xlab = "Observed Risk Difference", ylab = "Difference in Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
abline(v=0, col="grey")
abline(v=0.12, col="grey")
Table0 <- read.csv("../../output/Table0_merged.csv")
Table0 <- Table0[Table0$eff.mix.prob.x==10,]
par(mfrow=c(1,2))
x <- c(Table0$risk.diff.initial,Table0$risk.diff.final)
y <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
plot(x, y, xlab = "Observed Response Difference", ylab = "Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
y <- c(Table0$box.enth.initial,Table0$box.enth.final)
points(x,y, col=2)
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], col=2, lwd=2 )
abline(v=0, col="grey")
abline(v=0.12, col="grey")
y1 <- c(Table0$box.skpt.initial,Table0$box.skpt.final)
y2 <- c(Table0$box.enth.initial,Table0$box.enth.final)
y  <- y2 - y1
plot(x, y, xlab = "Observed Risk Difference", ylab = "Difference in Box's p-value")
model <- lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10))
myPredict <- predict( model )
ix <- sort(x,index.return=T)$ix
lines(x[ix], myPredict[ix], lwd=2 )
abline(v=0, col="grey")
abline(v=0.12, col="grey")
abline(h=0)

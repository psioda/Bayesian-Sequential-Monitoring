"3: Adaptive Weight Mixture",
"4: 75% Skeptical Mixture",
"5: 100% Skeptical (Default)"))
# # plot all fixed weight priors
# Table1        <- read.csv(file = "../../output/table1031920.csv", header = T)
# #Table1_ref    <- read.csv(file = "../../output/output062120/Table1/1Table1.csv")
# #names(Table1) <- names(Table1_ref)
# args          <- read.csv(file = "../../output/args_simulation031920.csv", header = F)
# args_ref      <- read.csv(file = "../args_simulation.csv")
# names(args)   <- names(args_ref)
# combined1     <- merge(args, Table1, by.x = "X", by.y = "idx")
# figure3       <- combined1
Table0  <- read.csv("../../output/Table0_merged_062320.csv")
figure3 <- aggregate(x   = Table0,
by  = list(Table0$p.IP, Table0$p.PC, Table0$eff.mix.prob.x),
FUN = mean)
## may need to change eff.mix.prob to eff.mix.prob.x
probs <- seq(0.25, 1, by = 0.25)
for (i in 1:length(probs)){
if (i == 1) row = 2
if (i == 2) row = 3
if (i == 3) row = 5
if (i == 4) row = 6
#row  <- i + 2
temp <- figure3[is.na(figure3$eff.mix.prob.x) == FALSE,]
temp <- temp[temp$eff.mix.prob.x == probs[i],]
temp.lines <- temp[temp$p.IP != 0.51,]
lines(temp.lines$p.IP,temp.lines$eff.mon.initial)
for (j in seq(1,length(temp$p.IP), by=6
)){
#   mtext(text=paste0(#format(round(temp$ss.initial[j],digits=1),nsmall=1),
#     #" + ",
#     #format(round(temp$ss.final[j]-
#     #               temp$ss.initial[j],digits=1),nsmall=1),
#     #" = ",
#     format(round(temp$ss.final[j],digits=1),nsmall=1)),
#     side=1,line=row,at=temp$p.IP[j])
}
text(temp$p.IP[j], temp$eff.mon.initial[j], row - 1)
# mtext(text=paste0(row - 1),side=1,line=row,at=stretch,adj=0)
}
# plot adaptive mixing prior
Table0  <- read.csv(file = "../../output/Table0_merged_062220.csv")
figure3 <- aggregate(x   = Table0,
by  = list(Table0$p.IP, Table0$p.PC, Table0$eff.mix.prob.x),
FUN = mean)
for (i in 5){
row <- 4
temp <- figure3[figure3$eff.mix.prob.x == 10, ]
#temp <- figure3[is.na(figure3$eff.mix.prob.x) == TRUE,]
lines(temp$p.IP,temp$eff.mon.initial)
for (j in seq(1,length(temp$p.IP)#, by=3
)){
#   mtext(text=paste0(#format(round(temp$ss.initial[j],digits=1),nsmall=1),
#     #" + ",
#     #format(round(temp$ss.final[j]-
#     #               temp$ss.initial[j],digits=1),nsmall=1),
#     #" = ",
#     format(round(temp$ss.final[j],digits=1),nsmall=1)),
#     side=1,line=row,at=temp$p.IP[j])
}
# mtext(text=paste0(1),side=1,line=row,at=stretch,adj=0)
text(temp$p.IP[j], temp$eff.mon.initial[j], row - 1)
}
axis(1,las=0,at=temp$p.IP[seq(1,length(temp$p.IP)#,by=3
)],
labels=format(temp$p.IP[seq(1,length(temp$p.IP)#,by=3
)],nsmall=2))
dev.off()
#############################################
#### Figure 6, Risk Diff Inference Plots ####
#############################################
rm(list = ls())
width.scale <- 8
png('../../../figure6.png',
width = 450*width.scale,
height = 300*width.scale,
pointsize=16,
res=300)
par(mar=c(5.1, 4.1, 4.1, 2.1)) #c(bottom, left, top, right)
stretch <- 0.37 # to add x-axis table under graph
# set initial plotting area
plot(NULL,
type = 'l',
xlim = c(.39, .63),
ylim = c(0,1),
lwd  = 1,
ylab = "Probability",
xlab = "Treatment Response Probability",
main = "",
xaxt = "n",
yaxt = "n")
abline(h = seq(0,1,by=0.1), col = "grey", lty = "dotted")
axis(2,las=0,at=seq(0,1,by=0.1),labels=seq(0,1,by=0.1))
mtext(text=c(as.expression(bquote(theta))),side=1,line=1,at=stretch,adj=0)
legend('topleft',
legend= c("1: 25% Skeptical (Mostly Enthusiastic)",
"2: 50% Skeptical",
"3: Adaptive Weight Mixture",
"4: 75% Skeptical Mixture",
"5: 100% Skeptical (Default)"))
# # plot all fixed weight priors
# Table1        <- read.csv(file = "../../output/table1031920.csv", header = T)
# #Table1_ref    <- read.csv(file = "../../output/output062120/Table1/1Table1.csv")
# #names(Table1) <- names(Table1_ref)
# args          <- read.csv(file = "../../output/args_simulation031920.csv", header = F)
# args_ref      <- read.csv(file = "../args_simulation.csv")
# names(args)   <- names(args_ref)
# combined1     <- merge(args, Table1, by.x = "X", by.y = "idx")
# figure3       <- combined1
Table0  <- read.csv("../../output/Table0_merged_062320.csv")
figure3 <- aggregate(x   = Table0,
by  = list(Table0$p.IP, Table0$p.PC, Table0$eff.mix.prob.x),
FUN = mean)
## may need to change eff.mix.prob to eff.mix.prob.x
probs <- seq(0.25, 1, by = 0.25)
for (i in 1:length(probs)){
if (i == 1) row = 2
if (i == 2) row = 3
if (i == 3) row = 5
if (i == 4) row = 6
#row  <- i + 2
temp <- figure3[is.na(figure3$eff.mix.prob.x) == FALSE,]
temp <- temp[temp$eff.mix.prob.x == probs[i],]
#temp.lines <- temp[temp$p.IP != 0.51,]
lines(temp$p.IP,temp$eff.mon.initial)
for (j in seq(1,length(temp$p.IP), by=6
)){
#   mtext(text=paste0(#format(round(temp$ss.initial[j],digits=1),nsmall=1),
#     #" + ",
#     #format(round(temp$ss.final[j]-
#     #               temp$ss.initial[j],digits=1),nsmall=1),
#     #" = ",
#     format(round(temp$ss.final[j],digits=1),nsmall=1)),
#     side=1,line=row,at=temp$p.IP[j])
}
text(temp$p.IP[j], temp$eff.mon.initial[j], row - 1)
# mtext(text=paste0(row - 1),side=1,line=row,at=stretch,adj=0)
}
# plot adaptive mixing prior
Table0  <- read.csv(file = "../../output/Table0_merged_062220.csv")
figure3 <- aggregate(x   = Table0,
by  = list(Table0$p.IP, Table0$p.PC, Table0$eff.mix.prob.x),
FUN = mean)
for (i in 5){
row <- 4
temp <- figure3[figure3$eff.mix.prob.x == 10, ]
#temp <- figure3[is.na(figure3$eff.mix.prob.x) == TRUE,]
lines(temp$p.IP,temp$eff.mon.initial)
for (j in seq(1,length(temp$p.IP)#, by=3
)){
#   mtext(text=paste0(#format(round(temp$ss.initial[j],digits=1),nsmall=1),
#     #" + ",
#     #format(round(temp$ss.final[j]-
#     #               temp$ss.initial[j],digits=1),nsmall=1),
#     #" = ",
#     format(round(temp$ss.final[j],digits=1),nsmall=1)),
#     side=1,line=row,at=temp$p.IP[j])
}
# mtext(text=paste0(1),side=1,line=row,at=stretch,adj=0)
text(temp$p.IP[j], temp$eff.mon.initial[j], row - 1)
}
axis(1,las=0,at=temp$p.IP[seq(1,length(temp$p.IP)#,by=3
)],
labels=format(temp$p.IP[seq(1,length(temp$p.IP)#,by=3
)],nsmall=2))
dev.off()
rm(list = ls())
width.scale <- 8
par(mar=c(5.1, 4.1, 4.1, 2.1)) #c(bottom, left, top, right)
stretch <- 0.37 # to add x-axis table under graph
# set initial plotting area
plot(NULL,
type = 'l',
xlim = c(.39, .63),
ylim = c(0,1),
lwd  = 1,
ylab = "Probability",
xlab = "Treatment Response Probability",
main = "",
xaxt = "n",
yaxt = "n")
abline(h = seq(0,1,by=0.1), col = "grey", lty = "dotted")
axis(2,las=0,at=seq(0,1,by=0.1),labels=seq(0,1,by=0.1))
mtext(text=c(as.expression(bquote(theta))),side=1,line=1,at=stretch,adj=0)
legend('topleft',
legend= c("1: 25% Skeptical (Mostly Enthusiastic)",
"2: 50% Skeptical",
"3: Adaptive Weight Mixture",
"4: 75% Skeptical Mixture",
"5: 100% Skeptical (Default)"))
Table0  <- read.csv("../../output/Table0_merged_062320.csv")
figure3 <- aggregate(x   = Table0,
by  = list(Table0$p.IP, Table0$p.PC, Table0$eff.mix.prob.x),
FUN = mean)
## may need to change eff.mix.prob to eff.mix.prob.x
probs <- seq(0.25, 1, by = 0.25)
for (i in 1:length(probs)){
if (i == 1) row = 2
if (i == 2) row = 3
if (i == 3) row = 5
if (i == 4) row = 6
#row  <- i + 2
temp <- figure3[is.na(figure3$eff.mix.prob.x) == FALSE,]
temp <- temp[temp$eff.mix.prob.x == probs[i],]
#temp.lines <- temp[temp$p.IP != 0.51,]
lines(temp$p.IP,temp$eff.mon.initial)
for (j in seq(1,length(temp$p.IP), by=6
)){
#   mtext(text=paste0(#format(round(temp$ss.initial[j],digits=1),nsmall=1),
#     #" + ",
#     #format(round(temp$ss.final[j]-
#     #               temp$ss.initial[j],digits=1),nsmall=1),
#     #" = ",
#     format(round(temp$ss.final[j],digits=1),nsmall=1)),
#     side=1,line=row,at=temp$p.IP[j])
}
text(temp$p.IP[j], temp$eff.mon.initial[j], row - 1)
# mtext(text=paste0(row - 1),side=1,line=row,at=stretch,adj=0)
}
axis(1,las=0,at=temp$p.IP[seq(1,length(temp$p.IP)#,by=3
)],
labels=format(temp$p.IP[seq(1,length(temp$p.IP)#,by=3
)],nsmall=2))
$p.IP[j]
#############################################
#### Figure 6, Risk Diff Inference Plots ####
#############################################
rm(list = ls())
width.scale <- 8
png('../../../figure6.png',
width = 450*width.scale,
height = 300*width.scale,
pointsize=16,
res=300)
par(mar=c(5.1, 4.1, 4.1, 2.1)) #c(bottom, left, top, right)
stretch <- 0.37 # to add x-axis table under graph
# set initial plotting area
plot(NULL,
type = 'l',
xlim = c(.39, .63),
ylim = c(0,1),
lwd  = 1,
ylab = "Probability",
xlab = "Treatment Response Probability",
main = "",
xaxt = "n",
yaxt = "n")
abline(h = seq(0,1,by=0.1), col = "grey", lty = "dotted")
axis(2,las=0,at=seq(0,1,by=0.1),labels=seq(0,1,by=0.1))
mtext(text=c(as.expression(bquote(theta))),side=1,line=1,at=stretch,adj=0)
legend('topleft',
legend= c("1: 25% Skeptical (Mostly Enthusiastic)",
"2: 50% Skeptical",
"3: Adaptive Weight Mixture",
"4: 75% Skeptical Mixture",
"5: 100% Skeptical (Default)"))
# # plot all fixed weight priors
# Table1        <- read.csv(file = "../../output/table1031920.csv", header = T)
# #Table1_ref    <- read.csv(file = "../../output/output062120/Table1/1Table1.csv")
# #names(Table1) <- names(Table1_ref)
# args          <- read.csv(file = "../../output/args_simulation031920.csv", header = F)
# args_ref      <- read.csv(file = "../args_simulation.csv")
# names(args)   <- names(args_ref)
# combined1     <- merge(args, Table1, by.x = "X", by.y = "idx")
# figure3       <- combined1
Table0  <- read.csv("../../output/Table0_merged_062320.csv")
figure3 <- aggregate(x   = Table0,
by  = list(Table0$p.IP, Table0$p.PC, Table0$eff.mix.prob.x),
FUN = mean)
## may need to change eff.mix.prob to eff.mix.prob.x
probs <- seq(0.25, 1, by = 0.25)
for (i in 1:length(probs)){
if (i == 1) row = 2
if (i == 2) row = 3
if (i == 3) row = 5
if (i == 4) row = 6
#row  <- i + 2
temp <- figure3[is.na(figure3$eff.mix.prob.x) == FALSE,]
temp <- temp[temp$eff.mix.prob.x == probs[i],]
#temp.lines <- temp[temp$p.IP != 0.51,]
lines(temp$p.IP,temp$eff.mon.initial)
for (j in seq(1,length(temp$p.IP)#, by=6
)){
#   mtext(text=paste0(#format(round(temp$ss.initial[j],digits=1),nsmall=1),
#     #" + ",
#     #format(round(temp$ss.final[j]-
#     #               temp$ss.initial[j],digits=1),nsmall=1),
#     #" = ",
#     format(round(temp$ss.final[j],digits=1),nsmall=1)),
#     side=1,line=row,at=temp$p.IP[j])
}
text(temp$p.IP[j], temp$eff.mon.initial[j], row - 1)
# mtext(text=paste0(row - 1),side=1,line=row,at=stretch,adj=0)
}
axis(1,las=0,at=temp$p.IP[seq(1,length(temp$p.IP)#,by=3
)],
labels=format(temp$p.IP[seq(1,length(temp$p.IP)#,by=3
)],nsmall=2))
# plot adaptive mixing prior
Table0  <- read.csv(file = "../../output/Table0_merged_062220.csv")
figure3 <- aggregate(x   = Table0,
by  = list(Table0$p.IP, Table0$p.PC, Table0$eff.mix.prob.x),
FUN = mean)
for (i in 5){
row <- 4
temp <- figure3[figure3$eff.mix.prob.x == 10, ]
#temp <- figure3[is.na(figure3$eff.mix.prob.x) == TRUE,]
lines(temp$p.IP,temp$eff.mon.initial)
for (j in seq(1,length(temp$p.IP)#, by=3
)){
#   mtext(text=paste0(#format(round(temp$ss.initial[j],digits=1),nsmall=1),
#     #" + ",
#     #format(round(temp$ss.final[j]-
#     #               temp$ss.initial[j],digits=1),nsmall=1),
#     #" = ",
#     format(round(temp$ss.final[j],digits=1),nsmall=1)),
#     side=1,line=row,at=temp$p.IP[j])
}
# mtext(text=paste0(1),side=1,line=row,at=stretch,adj=0)
text(temp$p.IP[j], temp$eff.mon.initial[j], row - 1)
}
dev.off()
#####################################
# Simulation parameters
# Evan Kwiatkowski, Feb 23, 2020
#
# The (fut|eff).mix.prob weights are
# assigned to the SKEPTICAL component
#####################################
rm(list = ls())
# simulation <- expand.grid(
#   seq(.39, 0.63, length = 2), # p.IP
#   .39, # p.PC
#   2,   # freq.mntr
#   1,   # enr.shape
#   4,   # out.mean
#   0,   # fut.mix.prob
#   seq(0.25,1,by=0.25),  # eff.mix.prob
#   0.5,  # inf.mix.prob
#   0.05, # cred.tail
#   100,  # max.ss
#   70,   # min.ss
#   100)   # reps
#
# simulation <- expand.grid(
#                    seq(.39, 0.63, length = 25), # p.IP
#                     .39, # p.PC
#                     2,   # freq.mntr
#                     1,   # enr.shape
#                     4,   # out.mean
#                     0,   # fut.mix.prob
#                     c(seq(1, 0.25, by = -0.25), NA), # eff.mix.prob
#                     0.5,  # inf.mix.prob
#                     0.05, # cred.tail
#                     100,  # max.ss
#                     70,   # min.ss
#                     50)   # reps
# simulation1 <- expand.grid(
#                    seq(.39, 0.63, length = 5), # p.IP
#                     .39, # p.PC
#                     10,   # freq.mntr
#                     1,   # enr.shape
#                     4,   # out.mean
#                     0,   # fut.mix.prob
#                     c(seq(1, 0.25, by = -0.25), NA), # eff.mix.prob
#                     0.5,  # inf.mix.prob
#                     0.05, # cred.tail
#                     100,  # max.ss
#                     70,   # min.ss
#                     1000)   # reps
# simulation2 <- expand.grid(
#                    seq(.42, .60, by = 0.06), # seq(.39, 0.63, length = 9), # p.IP
#                     rep(.39, 200), # p.PC
#                     2,   # freq.mntr
#                     1,   # enr.shape
#                     4,   # out.mean
#                     0,   # fut.mix.prob
#                     10,  # eff.mix.prob (10 means prior data conflcit)
#                     0.5,  # inf.mix.prob
#                     0.05, # cred.tail
#                     100,  # max.ss
#                     70,   # min.ss
#                     50)   # reps
simulation2 <- expand.grid(
seq(.39, .63, length = 5), # seq(.39, 0.63, length = 9), # p.IP
0.39, # p.PC
2,   # freq.mntr
1,   # enr.shape
4,   # out.mean
0,   # fut.mix.prob
rep(10, 160),  # eff.mix.prob (10 means prior data conflcit)
0.5,  # inf.mix.prob
0.05, # cred.tail
100,  # max.ss
70,   # min.ss
63)   # reps
#simulation <- rbind(simulation1, simulation2)
simulation  <- simulation2
names(simulation) <- c(
"p.IP",
"p.PC",
"freq.mntr",
"enr.shape",
"out.mean",
"fut.mix.prob",
"eff.mix.prob",
"inf.mix.prob",
"cred.tail",
"max.ss",
"min.ss",
"reps")
write.csv(x    = simulation, file = "args_simulation.csv")
getwd()
#############################################
#### Figure 6, Risk Diff Inference Plots ####
#############################################
rm(list = ls())
width.scale <- 8
png('../../../figure6.png',
width = 450*width.scale,
height = 300*width.scale,
pointsize=16,
res=300)
par(mar=c(5.1, 4.1, 4.1, 2.1)) #c(bottom, left, top, right)
stretch <- 0.37 # to add x-axis table under graph
# set initial plotting area
plot(NULL,
type = 'l',
xlim = c(.39, .63),
ylim = c(0,1),
lwd  = 1,
ylab = "Probability",
xlab = "Treatment Response Probability",
main = "",
xaxt = "n",
yaxt = "n")
abline(h = seq(0,1,by=0.1), col = "grey", lty = "dotted")
axis(2,las=0,at=seq(0,1,by=0.1),labels=seq(0,1,by=0.1))
mtext(text=c(as.expression(bquote(theta))),side=1,line=1,at=stretch,adj=0)
legend('topleft',
legend= c("1: 25% Skeptical (Mostly Enthusiastic)",
"2: 50% Skeptical",
"3: Adaptive Weight Mixture",
"4: 75% Skeptical Mixture",
"5: 100% Skeptical (Default)"))
# # plot all fixed weight priors
# Table1        <- read.csv(file = "../../output/table1031920.csv", header = T)
# #Table1_ref    <- read.csv(file = "../../output/output062120/Table1/1Table1.csv")
# #names(Table1) <- names(Table1_ref)
# args          <- read.csv(file = "../../output/args_simulation031920.csv", header = F)
# args_ref      <- read.csv(file = "../args_simulation.csv")
# names(args)   <- names(args_ref)
# combined1     <- merge(args, Table1, by.x = "X", by.y = "idx")
# figure3       <- combined1
Table0  <- read.csv("../../output/Table0_merged_062320.csv")
figure3 <- aggregate(x   = Table0,
by  = list(Table0$p.IP, Table0$p.PC, Table0$eff.mix.prob.x),
FUN = mean)
## may need to change eff.mix.prob to eff.mix.prob.x
probs <- seq(0.25, 1, by = 0.25)
for (i in 1:length(probs)){
if (i == 1) row = 2
if (i == 2) row = 3
if (i == 3) row = 5
if (i == 4) row = 6
#row  <- i + 2
temp <- figure3[is.na(figure3$eff.mix.prob.x) == FALSE,]
temp <- temp[temp$eff.mix.prob.x == probs[i],]
#temp.lines <- temp[temp$p.IP != 0.51,]
lines(temp$p.IP,temp$eff.mon.initial)
for (j in seq(1,length(temp$p.IP)#, by=6
)){
#   mtext(text=paste0(#format(round(temp$ss.initial[j],digits=1),nsmall=1),
#     #" + ",
#     #format(round(temp$ss.final[j]-
#     #               temp$ss.initial[j],digits=1),nsmall=1),
#     #" = ",
#     format(round(temp$ss.final[j],digits=1),nsmall=1)),
#     side=1,line=row,at=temp$p.IP[j])
}
text(temp$p.IP[j], temp$eff.mon.initial[j], row - 1)
# mtext(text=paste0(row - 1),side=1,line=row,at=stretch,adj=0)
}
axis(1,las=0,at=temp$p.IP[seq(1,length(temp$p.IP)#,by=3
)],
labels=format(temp$p.IP[seq(1,length(temp$p.IP)#,by=3
)],nsmall=2))
# plot adaptive mixing prior
Table0  <- read.csv(file = "../../output/Table0_merged_062220.csv")
figure3 <- aggregate(x   = Table0,
by  = list(Table0$p.IP, Table0$p.PC, Table0$eff.mix.prob.x),
FUN = mean)
for (i in 5){
row <- 4
temp <- figure3[figure3$eff.mix.prob.x == 10, ]
#temp <- figure3[is.na(figure3$eff.mix.prob.x) == TRUE,]
lines(temp$p.IP,temp$eff.mon.initial)
for (j in seq(1,length(temp$p.IP)#, by=3
)){
#   mtext(text=paste0(#format(round(temp$ss.initial[j],digits=1),nsmall=1),
#     #" + ",
#     #format(round(temp$ss.final[j]-
#     #               temp$ss.initial[j],digits=1),nsmall=1),
#     #" = ",
#     format(round(temp$ss.final[j],digits=1),nsmall=1)),
#     side=1,line=row,at=temp$p.IP[j])
}
# mtext(text=paste0(1),side=1,line=row,at=stretch,adj=0)
text(temp$p.IP[j], temp$eff.mon.initial[j], row - 1)
}
dev.off()
